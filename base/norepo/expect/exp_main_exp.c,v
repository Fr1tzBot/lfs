head	5.36;
access;
symbols
	expect_5_45:5.36
	expect_6_branch:5.36.0.2
	expect_5_44_1_15:5.36
	activestate_win32_port_start:5.32
	telco-tec-win32-take2-branch:5.30.0.6
	telco-tec-win32-branch:5.30.0.4
	expect-sf418892-sf439042-branch:5.30.0.2
	tclpro-1-5-0:5.30
	tclpro-1-4-1:5.30
	tclpro-1-4-0:5.30
	expect-5-32-2:5.30
	expect-5-32-0:5.30
	ajuba-ajuba2-2-0:5.29.2.1
	scriptics-sc-2-0-b5:5.29.2.1
	scriptics-sc-2-0-fixed:5.29.2.1
	scriptics-sc-2-0-b2:5.29.2.1
	scriptics-sc-2-0-b1:5.29.2.1
	scriptics-sc-1-1:5.29.2.1
	scriptics-sc-1-1-b1:5.29.2.1
	scriptics-sc-1-1-branch:5.29.2.1.0.4
	scriptics-sc-1-1-base:5.29.2.1
	scriptics-sc-1-0:5.29.2.1
	scriptics-sc-1-0-branch:5.29.2.1.0.2
	scriptics-sc-1-0-base:5.29.2.1
	expect-5-31-3:5.29.2.1
	scriptics-bc-1-0-b1:5.29.2.1
	scriptics-tclpro-1-3-0:5.29.2.1
	scriptics-tclpro-1-3-b4:5.29.2.1
	scriptics-tclpro-1-3-b3:5.29.2.1
	expect-5-31:5.29.2.1
	expect-5-31-branch:5.29.0.2
	expect-5-31-base:5.29
	scriptics-tclpro-1-2:5.29
	scriptics-tclpro-1-2-b2:5.28.1.1
	scriptics-tclpro-1-2-b1:5.28.1.1
	scriptics-tclpro-1-2-a1:5.28.1.1
	expect-5-28-1:5.28.1.1
	expect:5.28.1;
locks; strict;
comment	@ * @;


5.36
date	2010.07.01.00.53.49;	author eee;	state Exp;
branches;
next	5.35;

5.35
date	2010.03.11.21.47.37;	author eee;	state Exp;
branches;
next	5.34;

5.34
date	2008.04.03.19.19.41;	author andreas_kupries;	state Exp;
branches;
next	5.33;

5.33
date	2007.07.11.20.22.10;	author andreas_kupries;	state Exp;
branches;
next	5.32;

5.32
date	2003.02.15.00.02.39;	author andreas_kupries;	state Exp;
branches;
next	5.31;

5.31
date	2002.03.25.20.46.20;	author andreas_kupries;	state Exp;
branches;
next	5.30;

5.30
date	2000.01.06.23.22.04;	author wart;	state Exp;
branches
	5.30.2.1
	5.30.4.1
	5.30.6.1;
next	5.29;

5.29
date	99.02.12.23.51.46;	author libes;	state Exp;
branches
	5.29.2.1;
next	5.28;

5.28
date	98.10.14.22.53.22;	author cvsadmin;	state Exp;
branches
	5.28.1.1;
next	;

5.28.1.1
date	98.10.14.22.53.22;	author cvsadmin;	state Exp;
branches;
next	;

5.29.2.1
date	99.06.28.06.29.26;	author libes;	state Exp;
branches;
next	;

5.30.2.1
date	2001.07.06.23.15.46;	author andreas_kupries;	state Exp;
branches;
next	;

5.30.4.1
date	2001.10.02.23.04.51;	author davygrvy;	state dead;
branches;
next	;

5.30.6.1
date	2001.11.22.08.50.37;	author davygrvy;	state dead;
branches;
next	;


desc
@@


5.36
log
@Undoing all changes made by me during ANSIfication attempt, and
reverting to tag 'expect_5_44_1_15'.  Further ANSIfication will
be pursued on a branch.
@
text
@/* main.c - main() and some logging routines for expect

Written by: Don Libes, NIST, 2/6/90

Design and implementation of this program was paid for by U.S. tax
dollars.  Therefore it is public domain.  However, the author and NIST
would appreciate credit if this program or parts of it are used.
*/

/* Don't use stubs since we are in the main application. */
#undef USE_TCL_STUBS

#include "expect_cf.h"
#include <stdio.h>
#include "tcl.h"
#include "expect_tcl.h"
#include <stdlib.h>

int
main(argc, argv)
int argc;
char *argv[];
{
	int rc = 0;
	char buffer [30];

	Tcl_Interp *interp = Tcl_CreateInterp();
	Tcl_FindExecutable(argv[0]);

	if (Tcl_Init(interp) == TCL_ERROR) {
	    fprintf(stderr,"Tcl_Init failed: %s\n",Tcl_GetStringResult (interp));
	    (void) exit(1);
	}

	if (Expect_Init(interp) == TCL_ERROR) {
	    fprintf(stderr,"Expect_Init failed: %s\n",Tcl_GetStringResult (interp));
	    (void) exit(1);
	}

	exp_parse_argv(interp,argc,argv);

	/* become interactive if requested or "nothing to do" */
	if (exp_interactive)
		(void) exp_interpreter(interp,(Tcl_Obj *)0);
	else if (exp_cmdfile)
		rc = exp_interpret_cmdfile(interp,exp_cmdfile);
	else if (exp_cmdfilename)
		rc = exp_interpret_cmdfilename(interp,exp_cmdfilename);

	/* assert(exp_cmdlinecmds != 0) */

	/* SF #439042 -- Allow overide of "exit" by user / script
	 */

	sprintf(buffer, "exit %d", rc);
	Tcl_Eval(interp, buffer); 
	/*NOTREACHED*/
	return 0;		/* Needed only to prevent compiler warning. */
}

@


5.35
log
@Converting function declarations and definitions from K&R style
to ISO C style, along with occasional related comment changes.
@
text
@d20 3
a22 1
main(int argc, char *argv[])
@


5.34
log
@
	* configure.in: Bumped version to 5.44.1.7.
	* configure: Regen'd, autoconf 2.59.

	* The following set of changes was sent our way by Reinhard Max
	  <max@@tclers.tk>.

	* exp_command.c: Fixed more compiler warnings, and started
	* exp_command.h: to ansify the code base, beginning with
	* exp_inter.c: the introduction of proper function prototypes.
	* exp_main_exp.c:
	* exp_pty.h:
	* exp_tty.c:
	* exp_tty.h:
	* exp_win.c:
	* expect.c:
	* pty_termios.c:
	* retoglob.c:
@
text
@d20 1
a20 3
main(argc, argv)
int argc;
char *argv[];
@


5.33
log
@
	* Dbg.c: Cleaned up the direct access to interp->result,
	* exp_command.c: replaced with the proper functions and
	* expect.c: Tcl_Obj's.
	* exp_main_exp.c:
	* exp_main_sub.c:
	* exp_main_tk.c:
	* exp_prog.h:
	* exp_trap.c:
	* exp_tty.c:
	* exp_win.c:
	* exp_win.h:
@
text
@d17 1
@


5.32
log
@
	* configure.in:   Made expect aware of tcl stubs. Derived from the
	* exp_command.h:  patches to expect done by Steve Landers
	* exp_command.c:  <stevel@@digital-smarties.com>. Modifications:
	* exp_main_sub.c  No global cmdinfo structures for 'close' and
	* exp_main_exp.c: 'return'. Made this per-interpreter information
	* exp_main_tk.c:  as it should be. Using interp assoc data for this.

	NOTE: stubs is not default, but has to be activated via '--enable-stubs'.

	* configure:      Regenerated.
@
text
@d30 1
a30 1
	    fprintf(stderr,"Tcl_Init failed: %s\n",interp->result);
d35 1
a35 1
	    fprintf(stderr,"Expect_Init failed: %s\n",interp->result);
@


5.31
log
@
	* Merged fix for SF Bug #439042 into the HEAD (The source of the
	  patch is "expect-sf418892-sf439042-branch").
@
text
@d10 3
@


5.30
log
@Merge of expect5-31-branch to mainline
@
text
@d21 2
d48 5
a52 1
	Tcl_Exit(rc);
@


5.30.6.1
log
@A working set of code against Tcl8.4!
@
text
@@


5.30.4.1
log
@Top-level source files removed.
@
text
@@


5.30.2.1
log
@2001-07-06  Andreas Kupries <andreas_kupries@@users.sourceforge.net>

	* exp_main_exp.c:
	* exp_main_sub.c:
	* exp_main_tk.c:
	* exp_tty.c: Changed calls to 'Tcl_Exit' into calls to the command
	  [exit], to allow scripts and users to overide the functionality.
@
text
@a20 2
	char buffer [30];

d46 1
a46 5
	/* SF #439042 -- Allow overide of "exit" by user / script
	 */

	sprintf(buffer, "exit %d", rc);
	Tcl_Eval(interp, buffer); 
@


5.29
log
@numerous edits - getting synchronized (first time I've used CVS), see
HISTORY file for more info
@
text
@d25 2
a26 2
		fprintf(stderr,"Tcl_Init failed: %s\n",interp->result);
		exit(1);
d30 2
a31 2
		fprintf(stderr,"Expect_Init failed: %s\n",interp->result);
		exit(1);
d38 1
a38 1
		(void) exp_interpreter(interp);
d46 1
a46 1
	exp_exit(interp,rc);
@


5.29.2.1
log
@fixes throughout code but all tests and examples finally run
see NEWS file for summary
@
text
@d25 2
a26 2
	    fprintf(stderr,"Tcl_Init failed: %s\n",interp->result);
	    (void) exit(1);
d30 2
a31 2
	    fprintf(stderr,"Expect_Init failed: %s\n",interp->result);
	    (void) exit(1);
d38 1
a38 1
		(void) exp_interpreter(interp,(Tcl_Obj *)0);
d46 1
a46 1
	Tcl_Exit(rc);
@


5.28
log
@Initial revision
@
text
@d22 1
@


5.28.1.1
log
@Import of Expect v. 5.28.1
@
text
@@
