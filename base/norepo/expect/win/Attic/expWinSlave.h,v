head	1.1;
access;
symbols
	win32-jump-point-1:1.1.2.1.2.1
	telco-tec-win32-take2-branch:1.1.2.1.0.2
	telco-tec-win32-branch:1.1.0.2;
locks; strict;
comment	@ * @;


1.1
date	2001.09.13.02.01.49;	author davygrvy;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2001.09.13.02.01.49;	author davygrvy;	state Exp;
branches
	1.1.2.1.2.1;
next	1.1.2.2;

1.1.2.2
date	2001.10.11.02.41.47;	author davygrvy;	state Exp;
branches;
next	1.1.2.3;

1.1.2.3
date	2001.11.07.10.04.57;	author davygrvy;	state Exp;
branches;
next	1.1.2.4;

1.1.2.4
date	2001.11.09.01.17.40;	author davygrvy;	state dead;
branches;
next	;

1.1.2.1.2.1
date	2001.11.22.08.50.38;	author davygrvy;	state Exp;
branches;
next	;


desc
@@


1.1
log
@file expWinSlave.h was initially added on branch telco-tec-win32-branch.
@
text
@@


1.1.2.1
log
@snap29 "import"
@
text
@a0 106
/*
 * expWinSlave.h
 *
 *	Useful definitions used by the slave driver but not useful
 *	for anybody else.
 *
 * Copyright (c) 1997 by Mitel, Inc.
 * Copyright (c) 1997 by Gordon Chaffee (chaffee@@home.com)
 *
 * See the file "license.terms" for information on usage and redistribution
 * of this file, and for a DISCLAIMER OF ALL WARRANTIES.
 *
 */

typedef struct ExpSlaveDebugArg {
    HANDLE hMaster;		/* Output handle */
    HANDLE hConsole;		/* Console handle to use */
    HANDLE process;		/* Handle to subprocess */
    DWORD globalPid;		/* Program identifier of slave */
    HANDLE thread;		/* Handle of debugger thread */

    HANDLE event;		/* Gets set when the process has been created */
    DWORD result;		/* Result of process being started */
    DWORD lastError;		/* GetLastError for result */
    int passThrough;		/* Pass through mode? */
    int useSocket;		/* Communicate to master through socket */

    /* Args for ExpCreateProcess */
    int argc;			/* Number of args to start slave program */
    char **argv;		/* Argument list of slave program */
    HANDLE slaveStdin;		/* stdin for slave program */
    HANDLE slaveStdout;		/* stdout for slave program */
    HANDLE slaveStderr;		/* stderr for slave program */
} ExpSlaveDebugArg;

typedef struct _EXP_KEY {
    WORD wVirtualKeyCode;
    WORD wVirtualScanCode;
    DWORD dwControlKeyState;
} EXP_KEY;

#define EXP_KEY_CONTROL 0
#define EXP_KEY_SHIFT   1
#define EXP_KEY_LSHIFT  1
#define EXP_KEY_RSHIFT  2
#define EXP_KEY_ALT     3


/* For ExpVtFunctionToKeyArray.  Ordering must match ExpFunctionToKeyArray[] */
#define EXP_KEY_UP		0
#define EXP_KEY_DOWN		1
#define EXP_KEY_RIGHT		2
#define EXP_KEY_LEFT		3
#define EXP_KEY_END		4
#define EXP_KEY_HOME		5
#define EXP_KEY_PAGEUP		6
#define EXP_KEY_PAGEDOWN	7
#define EXP_KEY_INSERT		8
#define EXP_KEY_DELETE		9
#define EXP_KEY_SELECT		10
#define EXP_KEY_F1		11
#define EXP_KEY_F2		12
#define EXP_KEY_F3		13
#define EXP_KEY_F4		14
#define EXP_KEY_F5		15
#define EXP_KEY_F6		16
#define EXP_KEY_F7		17
#define EXP_KEY_F8		18
#define EXP_KEY_F9		19
#define EXP_KEY_F10		20
#define EXP_KEY_F11		21
#define EXP_KEY_F12		22
#define EXP_KEY_F13		23
#define EXP_KEY_F14		24
#define EXP_KEY_F15		25
#define EXP_KEY_F16		26
#define EXP_KEY_F17		27
#define EXP_KEY_F18		28
#define EXP_KEY_F19		29
#define EXP_KEY_F20		30
#define EXP_WIN_RESIZE		31

extern EXP_KEY ExpModifierKeyArray[];
extern EXP_KEY ExpAsciiToKeyArray[];
extern EXP_KEY ExpFunctionToKeyArray[];
extern DWORD   ExpConsoleInputMode;
extern HANDLE  ExpConsoleOut;
extern int     ExpDebug;

extern void			ExpAddToWaitQueue(HANDLE handle);
extern void			ExpKillProcessList();
extern DWORD WINAPI		ExpSlaveDebugThread(LPVOID *arg);
extern DWORD WINAPI		ExpGetExecutablePathA(PSTR pathInOut);
extern DWORD WINAPI		ExpGetExecutablePathW(PWSTR pathInOut);
extern BOOL			ExpWriteMaster(int useSocket, HANDLE hFile,
				    LPCVOID buf, DWORD n, LPOVERLAPPED over);
extern BOOL			ExpReadMaster(int useSocket, HANDLE hFile,
				    void *buf, DWORD n, PDWORD pCount,
				    LPOVERLAPPED over, PDWORD pError);
extern void			ExpNewConsoleSequences(int useSocket,
				    HANDLE hMaster, LPOVERLAPPED over);
extern void			ExpProcessFreeByHandle(HANDLE hProcess);
extern void			ExpSetConsoleSize(HANDLE hConsoleInW,
				    HANDLE hConsoleOut,
				    int w, int h, int useSocket,
				    HANDLE hMaster, LPOVERLAPPED over);
@


1.1.2.1.2.1
log
@A working set of code against Tcl8.4!
@
text
@d92 1
a92 1
extern DWORD WINAPI		ExpSlaveDebugThread(LPVOID arg);
@


1.1.2.2
log
@slavedrv.exe is building..  need to add Stubs startup code.
@
text
@d99 1
a99 1
				    LPWSAOVERLAPPED over, PDWORD pError);
d101 1
a101 1
				    HANDLE hMaster, LPWSAOVERLAPPED over);
d106 1
a106 1
				    HANDLE hMaster, LPWSAOVERLAPPED over);
@


1.1.2.3
log
@Numerous changes
@
text
@d1 2
a2 2
/* ----------------------------------------------------------------------------
 * expWinSlave.h --
d7 2
a8 1
 * ----------------------------------------------------------------------------
d10 2
a11 8
 * Written by: Don Libes, libes@@cme.nist.gov, NIST, 12/3/90
 * 
 * Design and implementation of this program was paid for by U.S. tax
 * dollars.  Therefore it is public domain.  However, the author and NIST
 * would appreciate credit if this program or parts of it are used.
 * 
 * Copyright (c) 1997 Mitel Corporation
 *	work by Gordon Chaffee <chaffee@@bmrc.berkeley.edu> for the WinNT port.
a12 10
 * Copyright (c) 2001 Telindustrie, LLC
 *	work by David Gravereaux <davygrvy@@pobox.com> for any Win32 OS.
 *
 * ----------------------------------------------------------------------------
 * URLs:    http://expect.nist.gov/
 *	    http://expect.sf.net/
 *	    http://bmrc.berkeley.edu/people/chaffee/expectnt.html
 * ----------------------------------------------------------------------------
 * RCS: @@(#) $Id: exp.h,v 1.1.2.5 2001/10/29 06:40:29 davygrvy Exp $
 * ----------------------------------------------------------------------------
d30 1
a30 1
    char **argv;		/* Argument list of slave program (in UTF-8) */
d90 6
a95 6
extern TCL_CPP void			ExpAddToWaitQueue(HANDLE handle);
extern TCL_CPP void			ExpKillProcessList();
extern TCL_CPP DWORD WINAPI		ExpSlaveDebugThread(LPVOID arg);
extern TCL_CPP DWORD WINAPI		ExpGetExecutablePathA(PSTR pathInOut);
extern TCL_CPP DWORD WINAPI		ExpGetExecutablePathW(PWSTR pathInOut);
extern TCL_CPP BOOL			ExpWriteMaster(int useSocket, HANDLE hFile,
d97 1
a97 1
extern TCL_CPP BOOL			ExpReadMaster(int useSocket, HANDLE hFile,
d100 1
a100 1
extern TCL_CPP void			ExpNewConsoleSequences(int useSocket,
d102 2
a103 2
extern TCL_CPP void			ExpProcessFreeByHandle(HANDLE hProcess);
extern TCL_CPP void			ExpSetConsoleSize(HANDLE hConsoleInW,
a106 4

/* Mailbox API */
extern TCL_CPP void SpawnOpenClientMailbox (const char *box);

@


1.1.2.4
log
@beginning the C++ rewrite.
@
text
@d26 1
a26 1
 * RCS: @@(#) $Id: expWinSlave.h,v 1.1.2.3 2001/11/07 10:04:57 davygrvy Exp $
@


