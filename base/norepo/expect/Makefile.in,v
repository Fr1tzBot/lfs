head	5.51;
access;
symbols
	expect_5_45:5.51
	expect_6_branch:5.45.0.2
	expect_5_44_1_15:5.45
	activestate_win32_port_start:5.39
	win32-jump-point-1:5.34
	telco-tec-win32-take2-branch:5.34.0.6
	telco-tec-win32-branch:5.34.0.4
	expect-sf418892-sf439042-branch:5.34.0.2
	tclpro-1-5-0:5.34
	tclpro-1-4-1:5.34
	tclpro-1-4-0:5.34
	expect-5-32-2:5.34
	expect-5-32-0:5.34
	ajuba-ajuba2-2-0:5.30.2.11
	scriptics-sc-2-0-b5:5.30.2.11
	scriptics-sc-2-0-fixed:5.30.2.11
	scriptics-sc-2-0-b2:5.30.2.11
	scriptics-sc-2-0-b1:5.30.2.11
	scriptics-sc-1-1:5.30.2.11
	scriptics-sc-1-1-b1:5.30.2.11
	scriptics-sc-1-1-branch:5.30.2.11.0.4
	scriptics-sc-1-1-base:5.30.2.11
	scriptics-sc-1-0:5.30.2.11
	scriptics-sc-1-0-branch:5.30.2.11.0.2
	scriptics-sc-1-0-base:5.30.2.11
	expect-5-31-3:5.30.2.11
	scriptics-bc-1-0-b1:5.30.2.9
	scriptics-tclpro-1-3-0:5.30.2.7
	scriptics-tclpro-1-3-b4:5.30.2.7
	scriptics-tclpro-1-3-b3:5.30.2.7
	expect-5-31:5.30.2.7
	expect-5-31-branch:5.30.0.2
	expect-5-31-base:5.30
	scriptics-tclpro-1-2:5.30
	scriptics-tclpro-1-2-b2:5.29
	scriptics-tclpro-1-2-b1:5.29
	scriptics-tclpro-1-2-a1:5.29
	expect-5-28-1:5.28.1.1
	expect:5.28.1;
locks; strict;
comment	@# @;


5.51
date	2010.09.30.17.14.07;	author andreas_kupries;	state Exp;
branches;
next	5.50;

5.50
date	2010.09.17.16.49.22;	author hobbs;	state Exp;
branches;
next	5.49;

5.49
date	2010.09.17.16.43.40;	author hobbs;	state Exp;
branches;
next	5.48;

5.48
date	2010.09.16.20.35.46;	author hobbs;	state Exp;
branches;
next	5.47;

5.47
date	2010.09.01.21.32.32;	author andreas_kupries;	state Exp;
branches;
next	5.46;

5.46
date	2010.08.27.21.51.53;	author hobbs;	state Exp;
branches;
next	5.45;

5.45
date	2008.10.03.17.05.14;	author andreas_kupries;	state Exp;
branches;
next	5.44;

5.44
date	2008.04.03.19.07.14;	author andreas_kupries;	state Exp;
branches;
next	5.43;

5.43
date	2007.06.28.19.23.37;	author andreas_kupries;	state Exp;
branches;
next	5.42;

5.42
date	2005.06.09.18.51.18;	author andreas_kupries;	state Exp;
branches;
next	5.41;

5.41
date	2004.07.15.20.24.39;	author andreas_kupries;	state Exp;
branches;
next	5.40;

5.40
date	2003.09.05.19.01.56;	author andreas_kupries;	state Exp;
branches;
next	5.39;

5.39
date	2003.02.17.19.27.54;	author andreas_kupries;	state Exp;
branches;
next	5.38;

5.38
date	2002.08.08.16.45.40;	author andreas_kupries;	state Exp;
branches;
next	5.37;

5.37
date	2002.05.09.14.03.44;	author libes;	state Exp;
branches;
next	5.36;

5.36
date	2002.04.16.21.00.28;	author libes;	state Exp;
branches;
next	5.35;

5.35
date	2002.03.23.04.55.04;	author libes;	state Exp;
branches;
next	5.34;

5.34
date	2000.06.08.19.17.20;	author libes;	state Exp;
branches;
next	5.33;

5.33
date	2000.04.27.15.30.07;	author libes;	state Exp;
branches;
next	5.32;

5.32
date	2000.01.06.23.22.01;	author wart;	state Exp;
branches;
next	5.31;

5.31
date	99.06.21.18.41.41;	author wart;	state Exp;
branches;
next	5.30;

5.30
date	99.02.12.23.51.45;	author libes;	state Exp;
branches
	5.30.2.1;
next	5.29;

5.29
date	98.12.03.04.35.49;	author suresh;	state Exp;
branches;
next	5.28;

5.28
date	98.10.14.22.53.21;	author cvsadmin;	state Exp;
branches
	5.28.1.1;
next	;

5.28.1.1
date	98.10.14.22.53.21;	author cvsadmin;	state Exp;
branches;
next	;

5.30.2.1
date	99.06.14.20.36.44;	author don;	state Exp;
branches;
next	5.30.2.2;

5.30.2.2
date	99.06.14.23.54.02;	author don;	state Exp;
branches;
next	5.30.2.3;

5.30.2.3
date	99.06.16.03.02.29;	author don;	state Exp;
branches;
next	5.30.2.4;

5.30.2.4
date	99.06.26.02.26.15;	author wart;	state Exp;
branches;
next	5.30.2.5;

5.30.2.5
date	99.06.30.01.42.47;	author hershey;	state Exp;
branches;
next	5.30.2.6;

5.30.2.6
date	99.06.30.22.36.05;	author wart;	state Exp;
branches;
next	5.30.2.7;

5.30.2.7
date	99.07.09.21.13.22;	author wart;	state Exp;
branches;
next	5.30.2.8;

5.30.2.8
date	99.08.24.23.47.22;	author libes;	state Exp;
branches;
next	5.30.2.9;

5.30.2.9
date	99.08.31.23.18.32;	author jenn;	state Exp;
branches;
next	5.30.2.10;

5.30.2.10
date	99.10.06.05.54.17;	author libes;	state Exp;
branches;
next	5.30.2.11;

5.30.2.11
date	99.10.29.18.50.38;	author libes;	state Exp;
branches;
next	;


desc
@@


5.51
log
@
	* Makefile.in: Continued work on the 'make dist' target (config.{sub,guess})
	* install.sh: Removed unused file.
	* mkinstalldirs: Removed unused file.
	* tclconfig/README.txt: Removed unused file.
	* testsuite/config/: Removed contents of unused directory.
	* test/.Sanitize: Removed unused file.
@
text
@# Makefile.in --
#
#	This file is a Makefile for Expect TEA Extension.  If it has the name
#	"Makefile.in" then it is a template for a Makefile;  to generate the
#	actual Makefile, run "./configure", which is a configuration script
#	generated by the "autoconf" program (constructs like "@@foo@@" will get
#	replaced in the actual Makefile.
#
# Copyright (c) 1999 Scriptics Corporation.
# Copyright (c) 2002-2005 ActiveState Corporation.
#
# See the file "license.terms" for information on usage and redistribution
# of this file, and for a DISCLAIMER OF ALL WARRANTIES.
#
# RCS: @@(#) $Id: Makefile.in,v 5.50 2010/09/17 16:49:22 hobbs Exp $

#========================================================================
#========================================================================

# expect must be setuid on crays in order to open ptys (and accordingly,
# you must run this Makefile as root).
# See the FAQ for more info on why this is necessary on Crays.
SETUID = @@SETUID@@
# SETUID = chmod u+s

LIB_RUNTIME_DIR = $(DESTDIR)@@libdir@@

# The following Expect scripts are not necessary to have installed as
# commands, but are very useful. Edit out what you don't want
# installed. The INSTALL file describes these and others in more
# detail. Some Make's screw up if you delete all of them because
# SCRIPTS is a target. If this is a problem, just comment out the
# SCRIPTS target itself.

SCRIPTS = timed-run timed-read ftp-rfc autopasswd lpunlock weather \
	passmass rftp kibitz rlogin-cwd xpstat tkpasswd dislocate xkibitz \
	tknewsbiff unbuffer mkpasswd cryptdir decryptdir autoexpect \
	multixterm

# A couple of the scripts have man pages of their own.
# You can delete these too if you don't want'em.

SCRIPTS_MANPAGES = kibitz dislocate xkibitz tknewsbiff unbuffer mkpasswd \
	passmass cryptdir decryptdir autoexpect multixterm


# allow us to handle null list gracefully, "end_of_list" should not exist

SCRIPT_LIST         = $(SCRIPTS) end_of_list
SCRIPT_MANPAGE_LIST = $(SCRIPTS_MANPAGES) end_of_list

# Short directory path where binaries can be found to support #! hack.
# This directory path can be the same as the directory in which the
# binary actually sits except when the path is so long that the #!
# mechanism breaks (usually at 32 characters). The solution is to
# create a directory with a very short name, which consists only of
# symbolic links back to the true binaries. Subtracting two for "#!"
# and a couple more for arguments (typically " -f" or " --") gives you
# 27 characters. Pathnames over this length won't be able to use the
# #! magic. For more info on this, see the execve(2) man page.

SHORT_BINDIR = $(exec_prefix)/bin

#========================================================================
# Nothing of the variables below this line should need to be changed.
# Please check the TARGETS section below to make sure the make targets
# are correct.
#========================================================================

#========================================================================
# The names of the source files is defined in the configure script.
# The object files are used for linking into the final library.
# This will be used when a dist target is added to the Makefile.
# It is not important to specify the directory, as long as it is the
# $(srcdir) or in the generic, win or unix subdirectory.
#========================================================================

PKG_SOURCES	= @@PKG_SOURCES@@
PKG_OBJECTS	= @@PKG_OBJECTS@@

PKG_STUB_SOURCES = @@PKG_STUB_SOURCES@@
PKG_STUB_OBJECTS = @@PKG_STUB_OBJECTS@@

#========================================================================
# PKG_TCL_SOURCES identifies Tcl runtime files that are associated with
# this package that need to be installed, if any.
#========================================================================

PKG_TCL_SOURCES = @@PKG_TCL_SOURCES@@

#========================================================================
# This is a list of public header files to be installed, if any.
#========================================================================

PKG_HEADERS	= @@PKG_HEADERS@@

#========================================================================
# "PKG_LIB_FILE" refers to the library (dynamic or static as per
# configuration options) composed of the named objects.
#========================================================================

PKG_LIB_FILE	= @@PKG_LIB_FILE@@
PKG_STUB_LIB_FILE = @@PKG_STUB_LIB_FILE@@

lib_BINARIES	= $(PKG_LIB_FILE)
bin_BINARIES	= expect
BINARIES	= $(lib_BINARIES) $(bin_BINARIES)

SHELL		= @@SHELL@@

srcdir		= @@srcdir@@
prefix		= @@prefix@@
exec_prefix	= @@exec_prefix@@

bindir		= @@bindir@@
libdir		= @@libdir@@
datadir		= @@datadir@@
mandir		= @@mandir@@
includedir	= @@includedir@@

DESTDIR		=

PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
pkgdatadir	= $(datadir)/$(PKG_DIR)
pkglibdir	= $(libdir)/$(PKG_DIR)
pkgincludedir	= $(includedir)/$(PKG_DIR)

top_builddir	= .

INSTALL		= @@INSTALL@@
INSTALL_PROGRAM	= @@INSTALL_PROGRAM@@
INSTALL_DATA	= @@INSTALL_DATA@@
INSTALL_SCRIPT	= @@INSTALL_SCRIPT@@

PACKAGE_NAME	= @@PACKAGE_NAME@@
PACKAGE_VERSION	= @@PACKAGE_VERSION@@
CC		= @@CC@@
CFLAGS_DEFAULT	= @@CFLAGS_DEFAULT@@
CFLAGS_WARNING	= @@CFLAGS_WARNING@@
CLEANFILES	= @@CLEANFILES@@
EXEEXT		= @@EXEEXT@@
LDFLAGS_DEFAULT	= @@LDFLAGS_DEFAULT@@
MAKE_LIB	= @@MAKE_LIB@@
MAKE_SHARED_LIB	= @@MAKE_SHARED_LIB@@
MAKE_STATIC_LIB	= @@MAKE_STATIC_LIB@@
MAKE_STUB_LIB	= @@MAKE_STUB_LIB@@
OBJEXT		= @@OBJEXT@@
RANLIB		= @@RANLIB@@
RANLIB_STUB	= @@RANLIB_STUB@@
SHLIB_CFLAGS	= @@SHLIB_CFLAGS@@
SHLIB_LD	= @@SHLIB_LD@@
SHLIB_LD_LIBS	= @@SHLIB_LD_LIBS@@
STLIB_LD	= @@STLIB_LD@@
TCL_DEFS	= @@TCL_DEFS@@
TCL_BIN_DIR	= @@TCL_BIN_DIR@@
TCL_SRC_DIR	= @@TCL_SRC_DIR@@
# Not used, but retained for reference of what libs Tcl required
TCL_LIBS	= @@TCL_LIBS@@

#========================================================================
# TCLLIBPATH seeds the auto_path in Tcl's init.tcl so we can test our
# package without installing.  The other environment variables allow us
# to test against an uninstalled Tcl.  Add special env vars that you
# require for testing here (like TCLX_LIBRARY).
#========================================================================

EXTRA_PATH	= $(top_builddir):$(TCL_BIN_DIR)
TCLSH_ENV	= TCL_LIBRARY=`@@CYGPATH@@ $(TCL_SRC_DIR)/library` \
		  @@LD_LIBRARY_PATH_VAR@@="$(EXTRA_PATH):$(@@LD_LIBRARY_PATH_VAR@@)" \
		  PATH="$(EXTRA_PATH):$(PATH)" \
		  TCLLIBPATH="$(top_builddir)"
TCLSH_PROG	= @@TCLSH_PROG@@
TCLSH		= $(TCLSH_ENV) $(TCLSH_PROG)
SHARED_BUILD	= @@SHARED_BUILD@@

INCLUDES	= @@PKG_INCLUDES@@ @@TCL_INCLUDES@@

PKG_CFLAGS	= @@PKG_CFLAGS@@

# TCL_DEFS is not strictly need here, but if you remove it, then you
# must make sure that configure.in checks for the necessary components
# that your library may use.  TCL_DEFS can actually be a problem if
# you do not compile with a similar machine setup as the Tcl core was
# compiled with.
#DEFS		= $(TCL_DEFS) @@DEFS@@ $(PKG_CFLAGS)
DEFS		= @@DEFS@@ $(PKG_CFLAGS)

CONFIG_CLEAN_FILES = Makefile

CPPFLAGS	= @@CPPFLAGS@@
LIBS		= @@PKG_LIBS@@ @@LIBS@@
AR		= @@AR@@
CFLAGS		= @@CFLAGS@@
COMPILE		= $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)

#========================================================================
# Start of user-definable TARGETS section
#========================================================================

#========================================================================
# TEA TARGETS.  Please note that the "libraries:" target refers to platform
# independent files, and the "binaries:" target inclues executable programs and
# platform-dependent libraries.  Modify these targets so that they install
# the various pieces of your package.  The make and install rules
# for the BINARIES that you specified above have already been done.
#========================================================================

all: binaries libraries doc

#========================================================================
# The binaries target builds executable programs, Windows .dll's, unix
# shared/static libraries, and any other platform-dependent files.
# The list of targets to build for "binaries:" is specified at the top
# of the Makefile, in the "BINARIES" variable.
#========================================================================

binaries: $(BINARIES) pkgIndex.tcl-hand

libraries:

doc:

install: all install-binaries install-libraries install-doc

install-binaries: binaries install-lib-binaries install-bin-binaries

#========================================================================
# This rule installs platform-independent files, such as header files.
#========================================================================

install-libraries: libraries $(SCRIPTS)
	@@mkdir -p $(DESTDIR)$(includedir)
	@@echo "Installing header files in $(DESTDIR)$(includedir)"
	@@list='$(PKG_HEADERS)'; for i in $$list; do \
	    echo "Installing $(srcdir)/$$i" ; \
	    $(INSTALL_DATA) $(srcdir)/$$i $(DESTDIR)$(includedir) ; \
	done;
# install standalone scripts and their man pages, if requested
	@@mkdir -p $(DESTDIR)$(prefix)/bin
	-for i in $(SCRIPT_LIST) ; do \
	  if [ -f $$i ] ; then \
	    $(INSTALL_PROGRAM) $$i $(DESTDIR)$(prefix)/bin/$$i ; \
	    rm -f $$i ; \
	  else true; fi ; \
	done

#========================================================================
# Install documentation.  Unix manpages should go in the $(mandir)
# directory.
#========================================================================

install-doc: doc
	@@mkdir -p $(DESTDIR)$(mandir)/man1
	@@mkdir -p $(DESTDIR)$(mandir)/man3
	@@echo "Installing documentation in $(DESTDIR)$(mandir)"
# install Expect man page
	$(INSTALL_DATA) $(srcdir)/expect.man $(DESTDIR)$(mandir)/man1/expect.1
# install man page for Expect library
	$(INSTALL_DATA) $(srcdir)/libexpect.man $(DESTDIR)$(mandir)/man3/libexpect.3
	-for i in $(SCRIPT_MANPAGE_LIST) ; do \
	  if [ -f $(srcdir)/example/$$i.man ] ; then \
	    $(INSTALL_DATA) $(srcdir)/example/$$i.man $(DESTDIR)$(mandir)/man1/$$i.1 ; \
	  else true; fi ; \
	done

test: binaries libraries
	$(TCLSH) `@@CYGPATH@@ $(srcdir)/tests/all.tcl` $(TESTFLAGS)

shell: binaries libraries
	@@$(TCLSH) $(SCRIPT)

expectshell: binaries libraries
	@@$(TCLSH_ENV) expect $(SCRIPT)

gdb:
	$(TCLSH_ENV) gdb $(TCLSH_PROG) $(SCRIPT)

depend:

#========================================================================
# $(PKG_LIB_FILE) should be listed as part of the BINARIES variable
# mentioned above.  That will ensure that this target is built when you
# run "make binaries".
#
# The $(PKG_OBJECTS) objects are created and linked into the final
# library.  In most cases these object files will correspond to the
# source files above.
#========================================================================

$(PKG_LIB_FILE): $(PKG_OBJECTS)
	-rm -f $(PKG_LIB_FILE)
	${MAKE_LIB}
	$(RANLIB) $(PKG_LIB_FILE)

$(PKG_STUB_LIB_FILE): $(PKG_STUB_OBJECTS)
	-rm -f $(PKG_STUB_LIB_FILE)
	${MAKE_STUB_LIB}
	$(RANLIB_STUB) $(PKG_STUB_LIB_FILE)

#========================================================================
# We need to enumerate the list of .c to .o lines here.
#
# In the following lines, $(srcdir) refers to the toplevel directory
# containing your extension.  If your sources are in a subdirectory,
# you will have to modify the paths to reflect this:
#
# Expect.$(OBJEXT): $(srcdir)/generic/Expect.c
# 	$(COMPILE) -c `@@CYGPATH@@ $(srcdir)/generic/Expect.c` -o $@@
#
# Setting the VPATH variable to a list of paths will cause the makefile
# to look into these paths when resolving .c to .obj dependencies.
# As necessary, add $(srcdir):$(srcdir)/compat:....
#========================================================================

VPATH = $(srcdir)

.c.@@OBJEXT@@:
	$(COMPILE) -c `@@CYGPATH@@ $<` -o $@@

#========================================================================
# Create the pkgIndex.tcl file.
# It is usually easiest to let Tcl do this for you with pkg_mkIndex, but
# you may find that you need to customize the package.  If so, either
# modify the -hand version, or create a pkgIndex.tcl.in file and have
# the configure script output the pkgIndex.tcl by editing configure.in.
#========================================================================

pkgIndex.tcl:
	( echo pkg_mkIndex . $(PKG_LIB_FILE) \; exit; ) | $(TCLSH)

pkgIndex.tcl-hand:
	(echo 'if {![package vsatisfies [package provide Tcl] @@TCL_VERSION@@]} {return}' ; \
	 echo 'package ifneeded Expect $(PACKAGE_VERSION) \
	    [list load [file join $$dir $(PKG_LIB_FILE)]]'\
	) > pkgIndex.tcl

#========================================================================
# Distribution creation
# You may need to tweak this target to make it work correctly.
#========================================================================

TAR		= tar
#COMPRESS	= tar cvf $(PKG_DIR).tar $(PKG_DIR); compress $(PKG_DIR).tar
COMPRESS	= $(TAR) zcvf $(PKG_DIR).tar.gz $(PKG_DIR)
DIST_ROOT	= /tmp/dist
DIST_DIR	= $(DIST_ROOT)/$(PKG_DIR)

dist-clean:
	rm -rf $(DIST_DIR) $(DIST_ROOT)/$(PKG_DIR).tar.*

dist: dist-clean doc
	mkdir -p $(DIST_DIR)
	cp -p $(srcdir)/ChangeLog $(srcdir)/README* $(srcdir)/license* \
		$(srcdir)/aclocal.m4 $(srcdir)/configure $(srcdir)/*.in \
		$(srcdir)/fixline1 \
		$(DIST_DIR)/
	chmod 664 $(DIST_DIR)/Makefile.in $(DIST_DIR)/aclocal.m4
	chmod 775 $(DIST_DIR)/configure $(DIST_DIR)/configure.in

	mkdir $(DIST_DIR)/tclconfig
	cp $(srcdir)/tclconfig/install-sh $(srcdir)/tclconfig/tcl.m4 \
	   $(srcdir)/tclconfig/config.guess $(srcdir)/tclconfig/config.sub \
		$(DIST_DIR)/tclconfig/
	chmod 664 $(DIST_DIR)/tclconfig/tcl.m4
	chmod +x $(DIST_DIR)/tclconfig/install-sh

	cp -p $(srcdir)/*.{c,h,man} $(srcdir)/vgrindefs $(srcdir)/NEWS \
		$(srcdir)/INSTALL $(srcdir)/FAQ $(srcdir)/HISTORY \
		$(DIST_DIR)/
	chmod 664 $(DIST_DIR)/*.{c,h,man}

	-list='demos example generic library tests unix win tests testsuite'; \
	for p in $$list; do \
	    if test -d $(srcdir)/$$p ; then \
		mkdir -p $(DIST_DIR)/$$p; \
		cp -p $(srcdir)/$$p/* $(DIST_DIR)/$$p/; \
	    fi; \
	done
	(cd $(DIST_ROOT); $(COMPRESS);)
	cp $(DIST_ROOT)/$(PKG_DIR).tar.gz $(top_builddir)

$(SCRIPTS):
	$(TCLSH) $(srcdir)/fixline1 $(SHORT_BINDIR) < $(srcdir)/example/$@@ > $@@

## We cannot use TCL_LIBS below (after TCL_LIB_SPEC) because its
## expansion references the contents of LIBS, which contains linker
## options we cannot use here (and which is what we are replacing in
## the first place).

expect:	exp_main_exp.o $(PKG_LIB_FILE)
	$(CC) \
		@@CFLAGS@@ \
		@@LDFLAGS_DEFAULT@@ \
		-o expect exp_main_exp.o \
		@@EXP_BUILD_LIB_SPEC@@ \
		@@TCL_LIB_SPEC@@ \
		@@TCL_DL_LIBS@@ @@PKG_LIBS@@ @@MATH_LIBS@@ \
		@@TCL_CC_SEARCH_FLAGS@@ \
		@@EXP_CC_SEARCH_FLAGS@@
	$(SETUID) expect

expectk:
	@@echo "expectk remove from distribution"
	@@echo "use tclsh with package require Tk and Expect"

#========================================================================
# Produce FAQ and homepage
#========================================================================

WEBDIR = /proj/itl/www/div826/subject/expect
VERSION = $(PACKAGE_VERSION)

# create the FAQ in html form
FAQ.html:	FAQ.src FAQ.tcl
	FAQ.src html > FAQ.html

# create the FAQ in text form
FAQ:	FAQ.src FAQ.tcl
	FAQ.src text > FAQ

# generate Expect home page
homepage.html:	homepage.src homepage.tcl expect.tar.gz.md5
	homepage.src > homepage.html

expect.tar.gz.md5:	expect-$(VERSION).tar.gz
	md5 expect-$(VERSION).tar.gz > expect.tar.gz.md5

# install various html docs on our web server
install-html:	FAQ.html homepage.html
	cp homepage.html $(WEBDIR)/index.html
	cp FAQ.html $(WEBDIR)

# HTMLize man pages for examples and push them out to the web server
example-man-pages:
	-for i in $(SCRIPT_MANPAGE_LIST) ; do \
	  if [ -f $(srcdir)/example/$$i.man ] ; then \
	    rman -f HTML $(srcdir)/example/$$i.man > $(srcdir)/example/$$i.man.html ; \
	    cp $(srcdir)/example/$$i.man.html $(FTPDIR)/example ; \
	  else true; fi ; \
	done

#========================================================================
# Push out releases
#========================================================================

FTPDIR = /proj/itl/www/div826/subject/expect

# make a private tar file for myself
tar:	expect-$(VERSION).tar
	mv expect-$(VERSION).tar expect.tar

# make a release and install it on ftp server
# update web page to reflect new version
ftp:	expect-$(VERSION).tar.Z expect-$(VERSION).tar.gz install-html homepage.html
	cp expect-$(VERSION).tar.Z $(FTPDIR)/expect.tar.Z
	cp expect-$(VERSION).tar.gz $(FTPDIR)/expect.tar.gz
	cp expect-$(VERSION).tar.gz $(FTPDIR)/old/expect-$(VERSION).tar.gz
	md5 $(FTPDIR)/expect.tar.gz > expect.tar.gz.md5
	cp HISTORY $(FTPDIR)
	cp README $(FTPDIR)/README.distribution
	cp example/README $(FTPDIR)/example
	cp `pubfile example` $(FTPDIR)/example
	ls -l $(FTPDIR)/expect.tar*
#	delete .Z temp file, still need .gz though for md5 later
	rm expect-$(VERSION).tar*

# make an alpha release and install it on ftp server
alpha:	expect-$(VERSION).tar.Z expect-$(VERSION).tar.gz
	cp expect-$(VERSION).tar.Z $(FTPDIR)/alpha.tar.Z
	cp expect-$(VERSION).tar.gz $(FTPDIR)/alpha.tar.gz
	cp HISTORY $(FTPDIR)
	rm expect-$(VERSION).tar*
	ls -l $(FTPDIR)/alpha.tar*

# make a beta release and install it on ftp server
beta:	expect-$(VERSION).tar.Z expect-$(VERSION).tar.gz
	rm -rf $(FTPDIR)/alpha.tar*
	cp expect-$(VERSION).tar.Z $(FTPDIR)/beta.tar.Z
	cp expect-$(VERSION).tar.gz $(FTPDIR)/beta.tar.gz
	cp HISTORY $(FTPDIR)
	rm expect-$(VERSION).tar*
	ls -l $(FTPDIR)/beta.tar*

expect-$(VERSION).tar: configure
	rm -f ../expect-$(VERSION)
	ln -s `pwd` ../expect-$(VERSION)
	cd ..;tar cvfh $@@ `pubfile expect-$(VERSION)`
	mv ../$@@ .

expect-$(VERSION).tar.Z:	expect-$(VERSION).tar
	compress -fc expect-$(VERSION).tar > $@@

expect-$(VERSION).tar.gz:	expect-$(VERSION).tar
	gzip -fc expect-$(VERSION).tar > $@@

#========================================================================
# End of user-definable section
#========================================================================

#========================================================================
# Don't modify the file to clean here.  Instead, set the "CLEANFILES"
# variable in configure.in
#========================================================================

clean:  
	-test -z "$(BINARIES)" || rm -f $(BINARIES)
	-rm -f *.$(OBJEXT) core *.core
	-test -z "$(CLEANFILES)" || rm -f $(CLEANFILES)

distclean: clean
	-rm -f *.tab.c
	-rm -f $(CONFIG_CLEAN_FILES)
	-rm -f config.cache config.log config.status

#========================================================================
# Install binary object libraries.  On Windows this includes both .dll and
# .lib files.  Because the .lib files are not explicitly listed anywhere,
# we need to deduce their existence from the .dll file of the same name.
# Library files go into the lib directory.
# In addition, this will generate the pkgIndex.tcl
# file in the install location (assuming it can find a usable tclsh shell)
#
# You should not have to modify this target.
#========================================================================

install-lib-binaries:
	@@mkdir -p $(DESTDIR)$(pkglibdir)
	@@list='$(lib_BINARIES)'; for p in $$list; do \
	  if test -f $$p; then \
	    echo " $(INSTALL_PROGRAM) $$p $(DESTDIR)$(pkglibdir)/$$p"; \
	    $(INSTALL_PROGRAM) $$p $(DESTDIR)$(pkglibdir)/$$p; \
	    stub=`echo $$p|sed -e "s/.*\(stub\).*/\1/"`; \
	    if test "x$$stub" = "xstub"; then \
		echo " $(RANLIB_STUB) $(DESTDIR)$(pkglibdir)/$$p"; \
		$(RANLIB_STUB) $(DESTDIR)$(pkglibdir)/$$p; \
	    else \
		echo " $(RANLIB) $(DESTDIR)$(pkglibdir)/$$p"; \
		$(RANLIB) $(DESTDIR)$(pkglibdir)/$$p; \
	    fi; \
	    ext=`echo $$p|sed -e "s/.*\.//"`; \
	    if test "x$$ext" = "xdll"; then \
		lib=`basename $$p|sed -e 's/.[^.]*$$//'`.lib; \
		if test -f $$lib; then \
		    echo " $(INSTALL_DATA) $$lib $(DESTDIR)$(pkglibdir)/$$lib"; \
	            $(INSTALL_DATA) $$lib $(DESTDIR)$(pkglibdir)/$$lib; \
		fi; \
	    fi; \
	  fi; \
	done
	@@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
	  if test -f $(srcdir)/$$p; then \
	    destp=`basename $$p`; \
	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
	  fi; \
	done
	@@if test "x$(SHARED_BUILD)" = "x1"; then \
	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
	fi

#========================================================================
# Install binary executables (e.g. .exe files and dependent .dll files)
# This is for files that must go in the bin directory (located next to
# wish and tclsh), like dependent .dll files on Windows.
#
# You should not have to modify this target, except to define bin_BINARIES
# above if necessary.
#========================================================================

install-bin-binaries:
	@@mkdir -p $(DESTDIR)$(bindir)
	@@list='$(bin_BINARIES)'; for p in $$list; do \
	  if test -f $$p; then \
	    echo " $(INSTALL_PROGRAM) $$p $(DESTDIR)$(bindir)/$$p"; \
	    $(INSTALL_PROGRAM) $$p $(DESTDIR)$(bindir)/$$p; \
	  fi; \
	done

.SUFFIXES: .c .$(OBJEXT) .man .n .html

Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
	cd $(top_builddir) \
	  && CONFIG_FILES=$@@ CONFIG_HEADERS= $(SHELL) ./config.status

uninstall-binaries:
	list='$(lib_BINARIES)'; for p in $$list; do \
	  rm -f $(DESTDIR)$(pkglibdir)/$$p; \
	done
	list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
	  p=`basename $$p`; \
	  rm -f $(DESTDIR)$(pkglibdir)/$$p; \
	done
	list='$(bin_BINARIES)'; for p in $$list; do \
	  rm -f $(DESTDIR)$(bindir)/$$p; \
	done

#========================================================================
#
# Target to regenerate header files and stub files from the *.decls tables.
#
#========================================================================

genstubs:
	$(TCLSH_PROG)	\
		$(srcdir)/tools/genStubs.tcl $(srcdir)/generic	\
		$(srcdir)/Expect.decls

#========================================================================
#
# Target to check that all exported functions have an entry in the stubs
# tables.
#
#========================================================================

Expect_DECLS = \
	$(srcdir)/expect.decls

checkstubs:
	-@@for i in `nm -p $(Expect_LIB_FILE) | awk '$$2 ~ /T/ { print $$3 }' \
		| sort -n`; do \
		match=0; \
		for j in $(Expect_DECLS); do \
		    if [ `grep -c $$i $$j` -gt 0 ]; then \
			match=1; \
		    fi; \
		done; \
		if [ $$match -eq 0 ]; then echo $$i; fi \
	done


.PHONY: all binaries clean depend distclean doc install libraries test chantest

# Tell versions [3.59,3.63) of GNU make to not export all variables.
# Otherwise a system limit (for SysV at least) may be exceeded.
.NOEXPORT:
@


5.50
log
@remove html dist piece
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 5.49 2010/09/17 16:43:40 hobbs Exp $
d355 1
d362 1
a378 1

d380 1
@


5.49
log
@	* Makefile.in: improved make dist target to include the necessary
	files, and remove old dist_orig.
	Enable Makefile regen target
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 5.48 2010/09/16 20:35:46 hobbs Exp $
d365 1
a365 1
	cp -p $(srcdir)/*.{c,h,man,html} $(srcdir)/vgrindefs $(srcdir)/NEWS \
d368 1
a368 1
	chmod 664 $(DIST_DIR)/*.{c,h,man,html}
@


5.48
log
@	* configure: regen with ac-2.59
	* tclconfig/tcl.m4: update for correct LDFLAGS on HP-UX
	* Makefile.in (expect): use TEA LDFLAGS instead of tclConfig.sh to
	build expect executable
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 5.47 2010/09/01 21:32:32 andreas_kupries Exp $
d342 1
d344 1
a344 1
COMPRESS	= gtar zcvf $(PKG_DIR).tar.gz $(PKG_DIR)
d353 1
a353 1
	cp -p $(srcdir)/ChangeLog $(srcdir)/README* $(srcdir)/doc/license* \
d365 6
a370 1
	-list='htdocs/art demos generic library mac tests unix win tea.tests tools tools/rules'; \
d374 1
a374 9
		cp -p $(srcdir)/$$p/*.* $(srcdir)/$$p/* $(DIST_DIR)/$$p/; \
	    fi; \
	done

	-list='doc'; \
	for p in $$list; do \
	    if test -d $$p ; then \
		mkdir -p $(DIST_DIR)/$$p; \
		cp -p $$p/*.* $$p/* $(DIST_DIR)/$$p/; \
a376 2
	-mv $(DIST_DIR)/htdocs/art $(DIST_DIR)/doc/art
	rm -rf $(DIST_DIR)/htdocs
a379 13
dist_orig:
	rm -rf $(PKG_DIR)*
	ls -d $(srcdir)/* > __FILES
	mkdir $(PKG_DIR)
	cp -rf `cat __FILES | grep -v __FILES` $(PKG_DIR)
	rm __FILES
	find $(PKG_DIR) -name CVS -prune -exec rm -rf {} \;
	cd $(PKG_DIR) ; $(TCLSH_PROG) PREPARE
	-tar cf - $(PKG_DIR) | gzip --best > $(PKG_DIR).tar.gz
	-tar cf - $(PKG_DIR) | bzip2 > $(PKG_DIR).tar.bz2
	-zip -r $(PKG_DIR).zip $(PKG_DIR)
	rm -rf $(PKG_DIR)

d580 3
a582 3
#Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
#	cd $(top_builddir) \
#	  && CONFIG_FILES=$@@ CONFIG_HEADERS= $(SHELL) ./config.status
@


5.47
log
@
	* Makefile.in: [Bug 865278] Semi-applied Don Porter's patch adding
	code which prevents the package from registering with Tcl
	interpreters which cannot load it, i.e. below the version it was
	compiled against. Semi because the pkgIndex.in in his patch is
	not used, the pkgIndex.tcl is generated by the Makefile(.in).
	* pkgIndex.in: Removed. File not used.
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 5.46 2010/08/27 21:51:53 hobbs Exp $
d408 1
a408 1
		@@TCL_LD_FLAGS@@ \
@


5.46
log
@	* config.guess, config.sub, expect.m4 (removed):
	* configure, configure.in, tclconfig/tcl.m4: Update to TEA 3.9
	* Makefile.in, aclocal.m4: Partial cleanup of the build system.
	* testsuite/Makefile.in:   Remove unused EXP_ from configure.in
	* testsuite/aclocal.m4:    and no longer use Tk.
	* testsuite/configure:     Update testsuite bits to use TEA info.
	* testsuite/configure.in:
	Update expect to version 5.45

	* Dbg.c: account for removal of tcldbgcf.h
	* DbgMkfl.in, Dbgconfig.in, Dbgconfigure, DbgpkgInd.in (removed):
	* tcldbgcf.h.in (removed): removed Dbg debugger subcomponent as it
	no longer built and debugger functionality is included in expect
	library and binary

	* pty_termios.c: add HAVE_STRING_H include string.h
	* exp_trap.c: add HAVE_STRING_H include string.h

	* expectk.man, exp_main_tk.c (removed): expectk no longer
	built. Use tclsh with package require Tk and Expect instead.

	* tests/all.tcl: add package require Expect

	* example/archie, example/autoexpect: minor code cleanup
	* example/tkpasswd, example/tknewsbiff, example/tkterm: use
	package require statements in lieu of expectk
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 5.45 2008/10/03 17:05:14 andreas_kupries Exp $
d332 2
a333 1
	(echo 'package ifneeded Expect $(PACKAGE_VERSION) \
@


5.45
log
@
	* configure.in: Bumped version to 5.44.1.11.
	* configure: Regen'd, autoconf 2.59.

	* exp_command.c (Exp_OverlayObjCmd): Fixed [Expect SF Bug 2127456]
	  reported by <eee@@users.sourceforge.net>, with thanks. Changed
	  retrieval of command from objv[0] (== 'overlay' itself), to
	  objv[i] containing the actual user command.

	* expect.c (string_case_first, string_first, eval_case_string):
	  Applied patch supplied by Andy Belsey <Andrew.Belsey@@Sun.COM>
	  fixing the seg.fault in 'expect -exact'. With thanks for both
	  the analysis of the problem and the patch. See also [Expect SF
	  Bug 2114547].
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 5.44 2008/04/03 19:07:14 andreas_kupries Exp $
d106 1
a106 1
bin_BINARIES	= expect expectk
a156 2
# This is necessary for packages that use private Tcl headers
TCL_TOP_DIR_NATIVE	= @@TCL_TOP_DIR_NATIVE@@
d176 1
a176 1
INCLUDES	= @@PKG_INCLUDES@@ @@TCL_INCLUDES@@ @@TK_INCLUDES@@
a255 2
# install Expectk man page if present
	$(INSTALL_DATA) $(srcdir)/expectk.man $(DESTDIR)$(mandir)/man1/expectk.1 ; \
d258 1
a258 1
# install man page for Expect and Expectk libraries
d272 3
d399 2
a400 2
## We cannot use @@TCL_LIBS@@ below (after TCL_LIB_SPEC) because its
## expansion references the contents of @@LIBS@@, which contains linker
a406 2
		@@EXP_CFLAGS@@ \
		@@EXP_SHLIB_CFLAGS@@ \
d411 1
a411 1
		@@DL_LIBS@@ @@PKG_LIBS@@ @@MATH_LIBS@@ \
d416 3
a418 14
expectk: exp_main_tk.o $(PKG_LIB_FILE)
	$(CC) \
		@@CFLAGS@@ \
		@@EXP_CFLAGS@@ \
		@@EXP_SHLIB_CFLAGS@@ \
		@@TCL_LD_FLAGS@@ \
		-o expectk exp_main_tk.o \
		@@EXP_BUILD_LIB_SPEC@@ \
		@@TK_LIB_SPEC@@ \
		@@TCL_LIB_SPEC@@ \
		@@TK_LIBS@@ \
		@@TCL_CC_SEARCH_FLAGS@@ \
		@@EXP_CC_SEARCH_FLAGS@@
	$(SETUID) expectk
@


5.44
log
@
	* configure.in: Bumped version to 5.44.1.6.
	* configure: Regen'd, autoconf 2.59.

	* The following set of changes was sent our way by Reinhard Max
	  <max@@tclers.tk>.

	* configure.in: Fixed checking of stty on linux, do not restrict
	  to specific cpu's. Further try with stdin, and stdin redirected
	  to /dev/tty when determining if stdout is read.

	* testsuite/configure.in: Brought up to TEA 3.5.
	* testsuite/aclocal.m4: New file, to import the TEA definitions.

	* Dbg.c: Added missed CONST in declaration and definition of
	  'debugger_trap'.

	* exp_command.c: Fixed pointer aliasing trouble with
	  'Tcl_DetachPids', and added the missing initialization of the
	  command string in the 'overlay' command.

	* expect.c: Fixed missing initialization of 'simple_start' element
	  of 'ecase'.

	* exp_inter.c: Fixed bogus use of 'slen' in 'intMatch'. The
	  relevant string is Tcl_Unichar, not Utf.

	* Makefile.in: Replaced bogus INSTALL_ROOT with DESTDIR, and added
	  missing DESTDIR references to the target for the installation of
	  the manpages.
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 5.43 2007/06/28 19:23:37 andreas_kupries Exp $
d610 3
a612 3
Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
	cd $(top_builddir) \
	  && CONFIG_FILES=$@@ CONFIG_HEADERS= $(SHELL) ./config.status
@


5.43
log
@
	* Merged changes from the official version 5.44.1 of expect into
	  the SF sources. See the details below.

	  --------------------
	  Marius Schamsula <marius173@@mchsi.xcom> reported tclconfig
	  missing, evidentally for new TEA.

	  Lots of massaging to fix TEAification of Makefile and configure
	  including that version numbers will now be full three part.

	  Daniel Wong <danielwong@@berkeley.xedu> noted the home page
	  should note that Wikipedia has a very readable entry for Expect.

	  Andre Alves <aalves@@escloyalty.xcom> noted passmass needed some
	  fixes to handle Solaris 9 passwd prompt changes.

	  Andreas fixed several things: changes to better support TEA, fix
	  debugger interaction with nonblocking mode, and probably other
	  things I'm overlooking.

	  Martin Dietze <di@@fh-wedel.xde> noted that autoconf 2.59 is
	  confused by C comment after undefs in expect_cf.h.in.

	  Added additional code to unbuffer -p so that if a process
	  earlier in the pipeline exits, unbuffer attempts to recover any
	  remaining output from the spawned proc before unbuffer itself
	  exits.

	  Jeffrey Hobbs noted that once stty was called, a bg'd script
	  would be suspended at exit.  Turned out to be overaggressive
	  code in stty that recorded what 'damage' the user might have
	  caused when calling stty in the first place.

	  Jens Petersen provided patch to make setpgrp configure better on
	  some Linux systems.

	  Added example/getpassck script to test for getpass bug.

	  multixterm had debugging stuff leftover ("hello").
	  --------------------
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 5.42 2005/06/09 18:51:18 andreas_kupries Exp $
d26 1
a26 1
LIB_RUNTIME_DIR = $(INSTALL_ROOT)@@libdir@@
d241 1
a241 1
	@@mkdir -p $(INSTALL_ROOT)$(prefix)/bin
d244 1
a244 1
	    $(INSTALL_PROGRAM) $$i $(INSTALL_ROOT)$(prefix)/bin/$$i ; \
d259 1
a259 1
	$(INSTALL_DATA) $(srcdir)/expectk.man $(mandir)/man1/expectk.1 ; \
d261 1
a261 1
	$(INSTALL_DATA) $(srcdir)/expect.man $(mandir)/man1/expect.1
d263 1
a263 1
	$(INSTALL_DATA) $(srcdir)/libexpect.man $(mandir)/man3/libexpect.3
d266 1
a266 1
	    $(INSTALL_DATA) $(srcdir)/example/$$i.man $(mandir)/man1/$$i.1 ; \
@


5.42
log
@
	* Makefile.in:  Upgraded build system to TEA 3.2.
	* configure.in:
	* config.guess:
	* config.sub
	* exp_main_sub.c:
	* aclocal.m4:
@
text
@d15 1
a15 1
# RCS: @@(#) $Id: Makefile.in,v 1.18 2005/03/18 01:56:23 hobbs Exp $
d435 90
@


5.41
log
@
	* Merged changes from the official version 5.42b0 of expect into
	  the SF sources. See details below (In the ChangeLog).
@
text
@d1 1
d3 5
a7 1
# Makefile for Expect
d9 16
d26 1
a26 100
VERSION_FULL = \"@@EXP_VERSION_FULL@@\"
VERSION = @@EXP_VERSION@@
# Tcl's tclConfig requires VERSION have a short-style version string.

srcdir = @@srcdir@@
VPATH = @@srcdir@@
SUBDIRS = @@subdirs@@

######################################################################
# The following lines are things you may want to change
######################################################################

# Tcl include files.  (If you haven't installed Tcl yet, read the README file).
# This must point to the directory that contains ALL of Tcl's include
# files, not just the public ones.
# TCLHDIRDASHI provided so that "-I" can be omitted if TCLHDIR is empty.
TCLHDIR = @@TCLHDIR@@
TCLHDIRDASHI = @@TCLHDIRDASHI@@
# Tcl's Tcl library (definitions of parray, etc)
TCL_LIBRARY = @@TCL_LIBRARY@@

# Tcl library uninstalled.  Should be something like -ltcl or ../tcl/libtcl.a
TCLLIB = @@TCL_BUILD_LIB_SPEC@@
# Tcl library installed.  Should be something like -ltcl or ../tcl/libtcl.a
TCLLIB_INSTALLED = @@TCL_LIB_SPEC@@

# The following definitions are only nec. if you want to use Tk with Expect.
# Tk include files
TKHDIRDASHI = @@TKHDIRDASHI@@
# Tk library
TKLIB = @@TK_BUILD_LIB_SPEC@@
TKLIB_INSTALLED = @@TK_LIB_SPEC@@
# X11 include files and other flags to compiler
X11_CFLAGS = @@TK_XINCLUDES@@
# X library
X11_LD_FLAGS =
X11_PROGS = @@X_PROGS@@
# X11_PROGS_INSTALLED should really be a separate symbol generated by configure but we're
# hitting configure's limit on substitutions, so be crude and use one less symbol.
X11_PROGS_INSTALLED = @@X_PROGS@@_installed

# Flags to pass to both cc and ld
# You should be able to leave this just the way it is.  However, here are some
# note if you run into problems:
#
# Avoid -O (optimize) unless you are convinced your optimizer is flawless
# (hint: not a chance).  I have heard many reports of -O causing Expect to
# misbehave.
# I encourage you to use -g (debugging).  While it is unlikely you will
# encounter an internal error in Expect, should this happen, I may just need
# the -g information and then you will need to recompile Expect.  As an aside,
# Expect is not a space or time pig, so this won't affect the performance of
# your Expect scripts.
# Note: On Linux systems which only have dynamic X libraries, the -g prevents
# the linker from using them.  So do not use -g on such systems.
CFLAGS = @@CFLAGS@@
#XCFLAGS = @@CFLAGS@@ @@EXP_CFLAGS@@ @@EXP_SHLIB_CFLAGS@@ 
XCFLAGS = @@CFLAGS@@ @@EXP_CFLAGS@@

# Libraries built with optimization switches have this additional extension
TCL_DBGX =              @@TCL_DBGX@@
TK_DBGX =		@@TK_DBGX@@

# From now on, CFLAGS is never used.  Instead, use XCFLAGS.  This is done so
# that we can provide a public interface for CFLAGS thereby allowing users
# to add to it on the Make command-line and still get the rest of the flags
# computed by configure.  Do this at your own risk - it obvious goes against
# the idea of configure's interface, however this is established tradition
# at some sites (e.g., Cygnus)!

# Flags to pass only to linker (after .o files but before libraries)
LDFLAGS = @@EXP_LDFLAGS@@

# Which C compiler to use.  For simplicity, we inherit the same definition
# used when Tcl was compiled.  Changing this definition here can screw up
# deductions that the configure script made on the assumption that you were
# using a different compiler. 
CC = @@CC@@

# By default, "make install" will install the appropriate files in
# /usr/local/bin, /usr/local/lib, /usr/local/man, etc.  By changing this
# variable, you can specify an installation prefix other than /usr/local.
# You may find it preferable to call configure with the --prefix option
# to control this information.  This is especially handy if you are
# installing Expect several times (perhaps on a number of machines or
# in different places).  Then you don't have to hand-edit this file.
# See the INSTALL file for more information.  (Analogous information
# applies to the next variable as well.)
prefix = @@prefix@@

# You can specify a separate installation prefix for architecture-specific
# files such as binaries and libraries.
exec_prefix = @@exec_prefix@@

# The following definition can be set to non-null for special systems
# like AFS with replication.  It allows the pathnames used for installation
# to be different than those used for actually reference files at
# run-time.  INSTALL_ROOT is prepended to $prefix and $exec_prefix
# when installing files.
INSTALL_ROOT =
d29 6
a34 4
# commands, but are very useful.  Edit out what you don't want installed.
# The INSTALL file describes these and others in more detail.
# Some Make's screw up if you delete all of them because SCRIPTS is a
# target.  If this is a problem, just comment out the SCRIPTS target itself.
d39 1
d42 1
a45 10
# Short directory path where binaries can be found to support #! hack.
# This directory path can be the same as the directory in which the binary
# actually sits except when the path is so long that the #! mechanism breaks
# (usually at 32 characters).
# The solution is to create a directory with a very short name, which consists
# only of symbolic links back to the true binaries.  Subtracting two for "#!"
# and a couple more for arguments (typically " -f" or " --") gives you 27
# characters.  Pathnames over this length won't be able to use the #! magic.
# For more info on this, see the execve(2) man page.
SHORT_BINDIR = $(exec_prefix)/bin
d47 1
a47 145
# If you have ranlib but it should be avoided, change this from "ranlib"
# to something innocuous like "echo".  Known systems with this problem:
# older SCO boxes.
UNSHARED_RANLIB = @@UNSHARED_RANLIB@@

# Change EVENT_ABLE to "noevent" if your system is:
# old SCO	because poll doesn't exist and select is broken on ptys
# 3b2 SVR3	because select doesn't exist and poll is broken on ptys
#    If you do use "noevent":
# 1) you must also edit expect_cf.h and change
#    "#undef SIMPLE_EVENT" to "#define SIMPLE_EVENT",
# 2) you cannot use any event facilities such as "after" or anything in Tk.
# 3) you cannot expect or interact with two or more processes simultaneously
#
EVENT_ABLE = @@EVENT_ABLE@@

# Change EVENT_TYPE to poll if your system is:
# NCR SVR4 (1.03.01)			where select is broken on ttys
# StarServer (SVR3 and SVR4.0)		where select is broken on ttys
#
# You will need to change EVENT_TYPE to select if your system is:
# Pyramid OSx in the att universe	where poll is broken (see LIBS below)
#
EVENT_TYPE = @@EVENT_TYPE@@

# Define default parameters for ptys.  This is used when 1) running in the
# background, 2) user has not defined the variable STTY_INIT to initialize
# ptys, and 3) the pty-driver's defaults suck.
#
# If your system doesn't understand "sane", try "cooked".  Apollo systems
# need nothing at all and should delete this line.  Systems using 8-bit
# character sets may need to disable parity.
# Systems that define sane to use @@ as line kill and # as erase should
# use something like "sane kill  erase ".
STTY = -DDFLT_STTY="\"@@DEFAULT_STTY_ARGS@@\""

######################################################################
# End of things you may want to change
#
# Do not change anything after this
######################################################################

bindir            = $(INSTALL_ROOT)@@bindir@@
bindir_arch_indep = $(INSTALL_ROOT)$(prefix)/bin
tcl_libdir        = $(INSTALL_ROOT)@@libdir@@
libdir            = $(INSTALL_ROOT)@@libdir@@/expect$(VERSION)
libdir_arch_indep = $(INSTALL_ROOT)$(prefix)/lib/expect$(VERSION)

mandir 	= $(INSTALL_ROOT)@@mandir@@
man1dir = $(mandir)/man1
man3dir = $(mandir)/man3
infodir = $(INSTALL_ROOT)@@infodir@@
includedir = $(INSTALL_ROOT)@@includedir@@

# Expect's utility script directories - arch-independent and arch-non-
# independent.  These correspond to the variables "exp_library" and
# "exp_exec_library".
SCRIPTDIR	= $(libdir_arch_indep)
EXECSCRIPTDIR	= $(libdir)

SHELL = @@EXP_CONFIG_SHELL@@

INSTALL = @@INSTALL@@
INSTALL_PROGRAM = @@INSTALL_PROGRAM@@
INSTALL_DATA = @@INSTALL_DATA@@

AR = ar
ARFLAGS = cr

LOCAL_EXPECT=LD_LIBRARY_PATH=.:@@TCL_EXEC_PREFIX@@/lib:$(tcl_libdir):$$LD_LIBRARY_PATH ./expect

# These definitions are used by the "subdirs_do" target to pass
# the compile flags down recursively.
FLAGS_TO_PASS = \
	"CC=$(CC)" \
	"CFLAGS=$(XCFLAGS)" \
	"CFLAGS_INT=$(CFLAGS_INT)" \
	"HDEFS=$(HDEFS)" \
	"INSTALL=$(INSTALL)" \
	"INSTALL_DATA=$(INSTALL_DATA)" \
	"INSTALL_PROGRAM=$(INSTALL_PROGRAM)" \
	"LDFLAGS=$(LDFLAGS)" \
	"RUNTEST=$(RUNTEST)" \
	"RUNTESTFLAGS=$(RUNTESTFLAGS)" \
	"SHLIB_CFLAGS=$(@@EXP_SHLIB_CFLAGS@@)" \
	"prefix=$(prefix)" \
	"exec_prefix=$(exec_prefix)"

#
# Following defines are for DejaGnu
#

# These let the DejaGnu test suite run when DejaGnu isn't 
# installed yet, so run it from the srcdir and objdir.
EXPECT = ` \
  if [ -f $${rootme}/expect ] ; then \
    echo $${rootme}/expect ; \
  else echo expect ; fi`

RUNTESTFLAGS =
RUNTEST = ` \
  if [ -f ${srcdir}/../dejagnu/runtest ] ; then \
    echo ${srcdir}/../dejagnu/runtest ; \
  else echo runtest ;  fi`

PTY_TYPE = @@PTY_TYPE@@
PTY = pty_$(PTY_TYPE)
CFILES = exp_command.c expect.c $(PTY).c \
	exp_inter.c exp_regexp.c exp_tty.c \
	exp_log.c exp_main_sub.c exp_pty.c \
	exp_trap.c exp_strf.c \
	exp_console.c exp_glob.c exp_win.c exp_clib.c \
	exp_closetcl.c exp_memmove.c exp_tty_comm.c \
	exp_$(EVENT_TYPE).c exp_$(EVENT_ABLE).c \
	exp_chan.c Dbg.c
OFILES = exp_command.o expect.o $(PTY).o exp_inter.o exp_regexp.o exp_tty.o \
	exp_log.o exp_main_sub.o exp_pty.o exp_trap.o \
	exp_console.o exp_strf.o exp_glob.o exp_win.o exp_clib.o \
	exp_closetcl.o exp_memmove.o exp_tty_comm.o \
	exp_$(EVENT_TYPE).o exp_$(EVENT_ABLE).o \
	exp_chan.o Dbg.o
SHARED_OFILES = shared/exp_command.o shared/expect.o shared/$(PTY).o \
	shared/exp_inter.o shared/exp_regexp.o shared/exp_tty.o \
	shared/exp_log.o shared/exp_main_sub.o shared/exp_pty.o \
	shared/exp_trap.o \
	shared/exp_console.o shared/exp_strf.o shared/exp_glob.o \
	shared/exp_win.o shared/exp_clib.o \
	shared/exp_closetcl.o shared/exp_memmove.o shared/exp_tty_comm.o \
	shared/exp_$(EVENT_TYPE).o shared/exp_$(EVENT_ABLE).o \
	shared/exp_chan.o shared/Dbg.o

# Expect libraries (both .a and shared)
EXP_LIB_FILES = @@EXP_LIB_FILES@@
# default Expect library (shared if possible, otherwise static)
EXP_LIB_FILE = @@EXP_LIB_FILE@@
# Expect object library (.a)
EXP_UNSHARED_LIB_FILE = @@EXP_UNSHARED_LIB_FILE@@
# Expect object library (shared, if possible)
EXP_SHARED_LIB_FILE = @@EXP_SHARED_LIB_FILE@@

# expect must be setuid on crays in order to open ptys (and accordingly,
# you must run this Makefile as root).
# See the FAQ for more info on why this is necessary on Crays.
SETUID = @@SETUID@@
# SETUID = chmod u+s
d49 1
a49 2
# allow us to handle null list gracefully, "end_of_list" should not exist
SCRIPT_LIST = $(SCRIPTS) end_of_list
d52 9
a60 51
# flags to pass only to the C compiler (not to ld)
# because STTY can include whitespace and quotes, pass STTY separately
CPPFLAGS = -I. -I$(srcdir) $(TCLHDIRDASHI) $(TKHDIRDASHI) $(X11_CFLAGS) \
		-DEXP_VERSION=$(VERSION_FULL) \
		-DSCRIPTDIR=\"$(SCRIPTDIR)\" \
		-DEXECSCRIPTDIR=\"$(EXECSCRIPTDIR)\" \
		-DTCL_DEBUGGER \
		-DUSE_NON_CONST \
		-DSTTY_BIN=\"@@STTY_BIN@@\"

# Flags to pass to cc (i.e. add to the end of the CLDFLAGS line below).
# Note that setting one will not set others automatically.  Set all that
# are relevant.
#
# NOTE THAT THESE FLAGS ARE NO LONGER SUPPORTED.  THE FUNCTIONALLY IS REPLACED
# BY THE AUTOMATIC CONFIGURATION CODE.  ONLY MESS WITH THE FOLLOWING DEFS IF
# YOU ARE POSITIVE THE AUTO CONFIG CODE IS FAILING.
# 
# -DSYSV3 if you are running SVR3 or later.
# -DSYSV4 if you are running SVR4.  This option does not preclude -DSYSV3.
# -DAUX2 if you are running Mac A/UX 2.
# -DMIPS_BSD if you are on a Mips machine using the BSD universe.
# -D_BSD_SIGNALS if you are on a Silicon Graphics AND want BSD semantics when
#	using the expect library.  Otherwise, you are better off just sticking
#	with rearming signals.

# Flags to pass to ld
# You may need to add additional ones to the end of the LIBS line below:
# -lc -lBSD     If you are using the BSD compatibility library on an HP/UX,
#		force libc.a to be loaded first.
# -lsocket	For SCO UNIX 3.2.2 (this should now be done automatically)
# -lX11		For Pyramid OSx, poll is broken, so use select from X lib
#  /usr/ucblib/libucb.a is needed for solaris 2.0 after -lm
EXP_AND_TCL_LIBS = $(LDFLAGS) @@EXP_AND_TCL_LIBS@@
EXP_AND_TK_LIBS = $(LDFLAGS) @@EXP_AND_TK_LIBS@@

CFLAGS_INT = $(MH_CFLAGS) $(CPPFLAGS) $(XCFLAGS)

LIB_INSTALL_DIR = $(tcl_libdir)
LIB_RUNTIME_DIR = $(tcl_libdir)
# I don't understand why Tcl splits these up, but it does.  LIB_RUNTIME_DIR
# can appear as part of the LD_SEARCH_FLAGS inherited by configure.

.c.o:
	$(CC) -c $(CFLAGS_INT) $(STTY) $(HDEFS) $<
	if [ "x$(EXP_UNSHARED_LIB_FILE)" != "x$(EXP_LIB_FILE)" ] ; then \
	   if [ ! -d shared ] ; then \
		mkdir shared ; \
	   else true; fi ; \
	   $(CC) -c $(CFLAGS_INT) @@EXP_SHLIB_CFLAGS@@ $(STTY) $(HDEFS) $< -o shared/$@@ ; \
	fi
d62 1
a62 1
all: binaries libraries doc
d64 145
a208 2
binaries: expect $(EXP_LIB_FILES) ${X11_PROGS}
	@@$(MAKE) subdir_do DO=$@@  $(FLAGS_TO_PASS)
d210 1
a210 1
libraries:
d212 6
a217 1
doc: info dvi
d219 1
a219 2
info:
dvi:
d221 1
a221 48
# build expect binary that does not depend on Expect's shared libs
# IFF static Tcl/Tk libraries are available.
expect:	exp_main_exp.o $(EXP_UNSHARED_LIB_FILE)
	$(CC) $(XCFLAGS) @@TCL_LD_FLAGS@@ -o expect exp_main_exp.o $(EXP_UNSHARED_LIB_FILE) $(TCLLIB) $(EXP_AND_TCL_LIBS)
	$(SETUID) expect

# install Expect library
# This is done before the install target because the libraries have to be
# in place before the installed expect is built.  Actually, only the shared
# lib has to be handled this way, but do both here for consistency.
# Can't seem to embed shell comments in backslashed lines, so comments here:
# - To allow bare "load" commands, install shared libs in tcl_libdir rather
#   than Expect's lib-specific directory (libdir).
# - install hand-generated pkgIndex.tcl file.
#   Local copy is pkgIndex rather than pkgIndex.tcl because pkgIndex.tcl.in
#   is too long for some filesystems, sigh.
install_shared_lib: $(EXP_LIB_FILES)
	${srcdir}/mkinstalldirs $(libdir)
	if [ -s $(EXP_UNSHARED_LIB_FILE) ] ; then \
	  $(INSTALL_DATA) $(EXP_UNSHARED_LIB_FILE) $(libdir)/$(EXP_UNSHARED_LIB_FILE) ; \
	  $(UNSHARED_RANLIB) $(libdir)/$(EXP_UNSHARED_LIB_FILE) ; \
	  $(INSTALL_DATA) $(EXP_UNSHARED_LIB_FILE) $(tcl_libdir)/$(EXP_UNSHARED_LIB_FILE) ; \
	  $(UNSHARED_RANLIB) $(tcl_libdir)/$(EXP_UNSHARED_LIB_FILE) ; \
	else true; fi
	if [ -s $(EXP_SHARED_LIB_FILE) ] ; then \
	  $(INSTALL_PROGRAM) $(EXP_SHARED_LIB_FILE) $(tcl_libdir)/$(EXP_SHARED_LIB_FILE) ; \
	  $(INSTALL_PROGRAM) pkgIndex $(libdir)/pkgIndex.tcl ; \
	else true; fi

expect_installed:	exp_main_exp.o $(EXP_LIB_FILE) install_shared_lib
	$(CC) $(XCFLAGS) @@EXP_SHLIB_CFLAGS@@ @@TCL_LD_FLAGS@@ -o expect_installed exp_main_exp.o @@EXP_LIB_SPEC@@ $(TCLLIB_INSTALLED) $(EXP_AND_TCL_LIBS)
	$(SETUID) expect_installed

# Build Expect with TestCenter
expect.tc: exp_main_exp.o $(OFILES) 
	proof $(CC) $(XCFLAGS) @@EXP_SHLIB_CFLAGS@@ @@TCL_LD_FLAGS@@ -o expect.tc $(OFILES) exp_main_exp.o $(TCLLIB) $(EXP_AND_TCL_LIBS) 
	$(SETUID) expect.tc

# Build an executable with both Expect and Tk
# IFF static Tcl/Tk libraries are available.
# Yes, I know that the link line can have libraries repeated.  This is a
# consequence of Tcl's configure combining the Tcl and X dependent libs
# together.  I could fix it by testing all the libraries (again, in Expect's
# configure) separately for Expectk, but as far as I know, it doesn't hurt
# anything here, so I'm not worrying about it.
expectk: exp_main_tk.o $(EXP_UNSHARED_LIB_FILE)
	$(CC) $(XCFLAGS) @@TCL_LD_FLAGS@@ -o expectk exp_main_tk.o $(EXP_UNSHARED_LIB_FILE) $(TKLIB) $(TCLLIB) $(X11_LD_FLAGS) $(EXP_AND_TK_LIBS) 
	$(SETUID) expectk
d223 1
a223 26
expectk_installed: exp_main_tk.o $(EXP_LIB_FILE)
	$(CC) $(XCFLAGS) @@EXP_SHLIB_CFLAGS@@ @@TCL_LD_FLAGS@@ -o expectk_installed exp_main_tk.o @@EXP_LIB_SPEC@@ $(TKLIB_INSTALLED) $(TCLLIB_INSTALLED) $(X11_LD_FLAGS) $(EXP_AND_TK_LIBS) 
	$(SETUID) expectk_installed

# Build Expectk with TestCenter
expectk.tc: exp_main_tk.o $(OFILES) 
	proof $(CC) $(XCFLAGS) @@TCL_LD_FLAGS@@ -o expectk.tc $(OFILES) exp_main_tk.o $(TKLIB) $(TCLLIB) $(X11_LD_FLAGS) $(EXP_AND_TK_LIBS) 
	$(SETUID) expectk.tc

expect-unshared-lib-file :: $(EXP_UNSHARED_LIB_FILE)
$(EXP_UNSHARED_LIB_FILE): $(OFILES)
	-rm -f $(EXP_UNSHARED_LIB_FILE)
	$(AR) $(ARFLAGS) $(EXP_UNSHARED_LIB_FILE) $(OFILES)
	-$(UNSHARED_RANLIB) $(EXP_UNSHARED_LIB_FILE)

# the dependency should really be SHARED_OFILES rather than OFILES
# but there's no way to write a rule that says shared/XYZ.o should
# depend on XYZ.c in a different directory (except by writing the
# rule out for each file, sigh).
expect-shared-lib-file :: $(EXP_SHARED_LIB_FILE)
$(EXP_SHARED_LIB_FILE): $(OFILES)
	-rm -f $(EXP_SHARED_LIB_FILE)
	@@TCL_SHLIB_LD@@ -o $(EXP_SHARED_LIB_FILE) $(SHARED_OFILES) @@EXP_LD_SEARCH_FLAGS@@ @@EXP_SHLIB_LD_LIBS@@

.PHONY: install-info install info
install-info:
d227 1
a227 25
install-binaries: expect expect_installed ${X11_PROGS_INSTALLED} $(SCRIPTS)
	${srcdir}/mkinstalldirs $(man1dir) $(man3dir) $(bindir) $(tcl_libdir) $(includedir)
# install Expect
	$(INSTALL_PROGRAM) expect_installed $(bindir)/expect
# install Expectk (and man page) if present
	-if [ -s expectk_installed ] ; then \
	  $(INSTALL_PROGRAM) expectk_installed $(bindir)/expectk ; \
	else true; fi
# install Expect's public include files
#	$(INSTALL_DATA) expect_cf.h $(includedir)
	$(INSTALL_DATA) $(srcdir)/expect.h $(includedir)
	$(INSTALL_DATA) $(srcdir)/expect_tcl.h $(includedir)
	$(INSTALL_DATA) $(srcdir)/expect_comm.h $(includedir)
# force installation of Tcl's private regexp definition - we simply have to
# make it public in order for people to use Expect's C lib.
# hmm - no longer appropriate for Tcl 8.2+ - work on better solution?
#	$(INSTALL_DATA) $(TCLHDIR)/tclRegexp.h $(includedir)
# install Debugger's public include file (just in case it's not there)
	$(INSTALL_DATA) $(srcdir)/tcldbg.h $(includedir)
# some people don't install Tcl, sigh
	TCL_LIBRARY=$(TCL_LIBRARY) ; \
	export TCL_LIBRARY ; \
	   if $(LOCAL_EXPECT) $(srcdir)/fixcat ; then \
	      $(INSTALL_DATA) $(srcdir)/fixcat $(EXECSCRIPTDIR)/cat-buffers ; \
	   else true; fi
d229 11
a239 1
install-libraries:
d241 1
a241 1
	${srcdir}/mkinstalldirs $(bindir_arch_indep) $(man1dir) $(SCRIPTDIR) $(EXECSCRIPTDIR)
d244 1
a244 1
	    $(INSTALL_PROGRAM) $$i $(bindir_arch_indep)/$$i ; \
d249 9
a257 2
install-doc:
	${srcdir}/mkinstalldirs $(man1dir) $(man3dir)
d259 1
a259 3
	-if [ -s expectk_installed ] ; then \
	  $(INSTALL_DATA) $(srcdir)/expectk.man $(man1dir)/expectk.1 ; \
	else true; fi
d261 1
a261 1
	$(INSTALL_DATA) $(srcdir)/expect.man $(man1dir)/expect.1
d263 1
a263 1
	$(INSTALL_DATA) $(srcdir)/libexpect.man $(man3dir)/libexpect.3
d266 1
a266 1
	    $(INSTALL_DATA) $(srcdir)/example/$$i.man $(man1dir)/$$i.1 ; \
d270 100
a369 26
$(SCRIPT_LIST):
	TCL_LIBRARY=$(TCL_LIBRARY) ; \
	export TCL_LIBRARY ; \
	$(LOCAL_EXPECT) $(srcdir)/fixline1 $(SHORT_BINDIR) < $(srcdir)/example/$@@ > $@@

# Delete all the installed files that the `install' target creates
# (but not the noninstalled files such as `make all' creates)
uninstall:
	-rm -f  $(bindir)/expectk \
		$(man1dir)/expect.1 \
		$(man1dir)/expectk.1 \
		$(libdir)/$(EXP_SHARED_LIB_FILE) \
		$(tcl_libdir)/$(EXP_SHARED_LIB_FILE) \
		$(libdir)/$(EXP_UNSHARED_LIB_FILE) \
		$(tcl_libdir)/$(EXP_UNSHARED_LIB_FILE) \
		$(libdir)/pkgIndex.tcl \
		$(man3dir)/libexpect.3 \
		$(includedir)/expect_cf.h \
		$(includedir)/expect.h \
		$(includedir)/expect_tcl.h \
		$(includedir)/expect_comm.h \
		$(EXECSCRIPTDIR)/cat-buffers
# debugger is not removed, since other things could depend on it
# remove standalone scripts and man pages
	-for i in $(SCRIPT_LIST) ; do \
	  rm -f $(bindir_arch_indep)/$$i ; \
d371 7
a377 2
	-for i in $(SCRIPT_MANPAGE_LIST) ; do \
	  rm -f $(man1dir)/$$i.1 ; \
d379 4
d384 63
a446 53
###################################
# Targets for Makefile and configure
###################################

#Makefile: $(srcdir)/Makefile.in $(host_makefile_frag) config.status
#	@@echo "Rebuilding the Makefile..."
#	$(SHELL) ./config.status
#
# Let "make -f Makefile.in" produce a configure file
#configure: $(srcdir)/configure.in $(srcdir)/Makefile.in \
#		$(srcdir)/expect_cf.h.in $(srcdir)/aclocal.m4
#	@@echo "Rebuilding configure..."
#	if [ x"${srcdir}" = x"@@srcdir@@" ] ; then \
#	  srcdir=. ; export srcdir ; \
#	else true ; fi ; \
#	(cd $${srcdir}; autoconf)
#
#config.status: $(srcdir)/configure
#	@@echo "Rebuilding config.status..."
#	$(SHELL) ./config.status --recheck

check:
	@@if [ -f testsuite/Makefile ]; then \
	   cd testsuite && $(MAKE) $(FLAGS_TO_PASS) check; \
	else true; fi

# Original Dbgconfig.in comes from the NIST Tcl debugger distribution.
# This rule is not an explicit dependency from any other rule in this
# Makefile.  It is not necessary, as the debugger distribution itself
# keeps it up to date.  However, if the debugger distribution is not
# around, this rule can be used.
Dbgconfigure: $(srcdir)/Dbgconfig.in $(srcdir)/Makefile.in \
		$(srcdir)/tcldbgcf.h.in $(srcdir)/aclocal.m4
	@@echo "Rebuilding Dbgconfigure..."
	@@if [ x"${srcdir}" = x"@@srcdir@@" ] ; then \
	  srcdir=. ; export srcdir ; \
	else true ; fi ; \
	(cd $${srcdir}; rm -fr Dbgconfigure ; \
	 autoconf Dbgconfig.in > Dbgconfigure ; \
	 chmod a+x Dbgconfigure)

################################################
# Various "clean" targets follow GNU conventions
################################################

# delete all files from current directory that are created by "make"
clean:
	-rm -rf *~ *.o shared core \
		expect expect_installed expectk expectk_installed \
		dumb exho devtty \
		$(EXP_UNSHARED_LIB_FILE) $(EXP_SHARED_LIB_FILE) \
		$(SCRIPT_LIST)
	@@$(MAKE) subdir_do DO=$@@ $(FLAGS_TO_PASS)
a447 1
# like "clean", but also delete files created by "configure"
d449 92
a540 200
	@@$(MAKE) subdir_do DO=$@@  $(FLAGS_TO_PASS)
	-rm -f Makefile config.status config.cache config.log expect_cf.h
	-rm -f tcldbgcf.h

# like "clean", but doesn't delete test utilities or massaged scripts
# because most people don't have to worry about them
mostlyclean:
	-rm -rf *~ *.o shared core \
		expect expect_installed expectk expectk_installed \
		$(EXP_UNSHARED_LIB_FILE) $(EXP_SHARED_LIB_FILE)
	@@$(MAKE) subdir_do DO=$@@ $(FLAGS_TO_PASS)

# delete everything from current directory that can be reconstructed
# except for configure
realclean:	distclean

##################################
# Targets for development at NIST
##################################

# the unsets allow calling this via Makefile.in

nist:
	unset CC ; \
	configure --verbose --prefix=/depot/tcl --exec-prefix=/depot/tcl/arch

epg:
	unset CC ; \
	echo configure --verbose --prefix=/home/libes --exec-prefix=/home/libes/arch

mink:
	unset CC ; \
	configure --verbose --prefix=/usr/tmp --exec-prefix=/usr/tmp/arch

cam:
	unset CC ; \
	configure --verbose --prefix=/tmp_mnt/home/fs1a/libes \
		      --exec-prefix=/tmp_mnt/home/fs1a/libes/arch

granta:
	unset CC ; \
	configure --verbose --prefix=/home/nist/libes/cray --exec-prefix=/home/nist/libes/cray/arch


hudson:
	unset CC ; \
	configure --verbose --prefix=/granta/home/nist/libes/ibm --exec-prefix=/granta /home/nist/libes/ibm/arch

# report globals that shouldn't be public but are
bad_globals:
	nm $(EXP_UNSHARED_LIB_FILE) | egrep -v " [a-zU] | _exp| _Exp| _Dbg"

LINTFLAGS = -h -q -x 

lint:
	lint $(LINTFLAGS) $(CPPFLAGS) $(STTY) $(CFILES) exp_main_exp.c $(TCLLINTLIB) | tee expect.lint

# after copying source directory, reestablish all links
symlink:
	rm -rf Dbg* tcldbg* e ek testsuite/aclocal.m4
	ln -s ../tcl-debug/configure	Dbgconfigure
	ln -s ../tcl-debug/configure.in	Dbgconfig.in
	ln -s ../tcl-debug/Makefile.in	DbgMkfl.in
	ln -s ../tcl-debug/pkgIndex.in	DbgpkgInd.in
	ln -s ../tcl-debug/tcldbgcf.h.in
	ln -s ../tcl-debug/tcldbg.h
	ln -s ../tcl-debug/Dbg.c
	ln -s ../aclocal.m4 testsuite

#########################################
# Targets for building with CodeCenter
#########################################

GCCROOT = /depot/gnu/arch/lib/gcc-lib/sparc-sun-sunos4.1/2.3.3
GCCLIB = $(GCCROOT)/libgcc.a
GCCINC = -I$(GCCROOT)/include
# following only on Sparcs
SABERDEFINE = -D__sparc__

# Following target builds expect under CodeCenter.
# Note that CodeCenter doesn't understand backslashes in STTY - there is a
# default value in the code itself that is used.  So if you don't use the default,
# you'll have to hand-edit the source.
# If using ObjectCenter, before loading, type: setopt primary_language C
exp:	$(CFILES) exp_main_exp.c
	#load $(CPPFLAGS) $(CFILES) exp_main_exp.c $(TCLLIB) $(GCCLIB) $(EXP_AND_TCL_LIBS)

# Following target builds expectk under CodeCenter.  Notes:
# Because of explicit #includes of <X11/...> in tk.h, you need to create
# a symlink from your X11 include directory to this directory
tk:     $(CFILES) exp_main_tk.c
	#load $(CPPFLAGS) $(STTY) $(CFILES) exp_main_tk.c $(TKLIB) $(TCLLIB) $(EXP_AND_TK_LIBS)

# Follow definitions are for building expect and expectk under ObjectCenter
oexp:   $(CFILES) exp_main_exp.c
	#load $(CPPFLAGS) $(STTY) -C $(CFILES) exp_main_exp.c $(TCLLIB) $(GCCLIB) $(EXP_AND_TCL_LIBS)

otk:    $(CFILES) exp_main_tk.c
	#load $(CPPFLAGS) $(STTY) -C $(CFILES) exp_main_tk.c $(TKLIB) $(TCLLIB) $(EXP_AND_TK_LIBS)

######################################
# Targets for pushing out releases
######################################

FTPDIR = /proj/itl/www/div826/subject/expect

# make a private tar file for myself
tar:	expect-$(VERSION).tar
	mv expect-$(VERSION).tar expect.tar

# make a release and install it on ftp server
# update web page to reflect new version
ftp:	expect-$(VERSION).tar.Z expect-$(VERSION).tar.gz install-html homepage.html
	cp expect-$(VERSION).tar.Z $(FTPDIR)/expect.tar.Z
	cp expect-$(VERSION).tar.gz $(FTPDIR)/expect.tar.gz
	cp expect-$(VERSION).tar.gz $(FTPDIR)/old/expect-@@EXP_VERSION_FULL@@.tar.gz
	md5 $(FTPDIR)/expect.tar.gz > expect.tar.gz.md5
	cp HISTORY $(FTPDIR)
	cp README $(FTPDIR)/README.distribution
	cp example/README $(FTPDIR)/example
	cp `pubfile example` $(FTPDIR)/example
	ls -l $(FTPDIR)/expect.tar*
#	delete .Z temp file, still need .gz though for md5 later
	rm expect-$(VERSION).tar*

# make an alpha release and install it on ftp server
alpha:	expect-$(VERSION).tar.Z expect-$(VERSION).tar.gz
	cp expect-$(VERSION).tar.Z $(FTPDIR)/alpha.tar.Z
	cp expect-$(VERSION).tar.gz $(FTPDIR)/alpha.tar.gz
	cp HISTORY $(FTPDIR)
	rm expect-$(VERSION).tar*
	ls -l $(FTPDIR)/alpha.tar*

# make a beta release and install it on ftp server
beta:	expect-$(VERSION).tar.Z expect-$(VERSION).tar.gz
	rm -rf $(FTPDIR)/alpha.tar*
	cp expect-$(VERSION).tar.Z $(FTPDIR)/beta.tar.Z
	cp expect-$(VERSION).tar.gz $(FTPDIR)/beta.tar.gz
	cp HISTORY $(FTPDIR)
	rm expect-$(VERSION).tar*
	ls -l $(FTPDIR)/beta.tar*

expect-$(VERSION).tar: configure
	rm -f ../expect-$(VERSION)
	ln -s `pwd` ../expect-$(VERSION)
	cd ..;tar cvfh $@@ `pubfile expect-$(VERSION)`
	mv ../$@@ .

expect-$(VERSION).tar.Z:	expect-$(VERSION).tar
	compress -fc expect-$(VERSION).tar > $@@

expect-$(VERSION).tar.gz:	expect-$(VERSION).tar
	gzip -fc expect-$(VERSION).tar > $@@

test:   expect
	rm -f .tmp
	echo "set objdir" `pwd` > .tmp
	if [ "$(srcdir)" = "." ] ; then \
	   echo "set srcdir" `pwd` >> .tmp ; \
	else echo "set srcdir" $(srcdir) >> .tmp ; fi
	echo "cd \$${srcdir}/tests" >> .tmp
	echo "source all.tcl" >> .tmp
	rootme=`pwd`; export rootme; \
	srcdir=${srcdir} ; export srcdir ; \
	if [ -f ./expect ] ; then  \
	   TCL_LIBRARY=$(TCL_LIBRARY) ; \
	   export TCL_LIBRARY ; fi ; \
	$(LOCAL_EXPECT) -f .tmp
	rm -f .tmp

###########################
# Targets for producing FAQ and homepage
###########################

#WEBDIR = /proj/elib/online/pub/expect
WEBDIR = /proj/itl/www/div826/subject/expect

# create the FAQ in html form
FAQ.html:	FAQ.src FAQ.tcl
	FAQ.src html > FAQ.html

# create the FAQ in text form
FAQ:	FAQ.src FAQ.tcl
	FAQ.src text > FAQ

# generate Expect home page
homepage.html:	homepage.src homepage.tcl expect.tar.gz.md5
	homepage.src > homepage.html

expect.tar.gz.md5:	expect-$(VERSION).tar.gz
	md5 expect-$(VERSION).tar.gz > expect.tar.gz.md5

#expect.tar.gz.md5:	$(FTPDIR)/expect.tar.gz
#	md5 $(FTPDIR)/expect.tar.gz > expect.tar.gz.md5

# install various html docs on our web server
install-html:	FAQ.html homepage.html
	cp homepage.html $(WEBDIR)/index.html
	cp FAQ.html $(WEBDIR)
#	cp FAQ.src $(WEBDIR)
d542 4
d547 6
d554 2
a555 1
#	cp FAQ.tcl $(WEBDIR)
d557 10
a566 7
# HTMLize man pages for examples and push them out to the web server
example-man-pages:
	-for i in $(SCRIPT_MANPAGE_LIST) ; do \
	  if [ -f $(srcdir)/example/$$i.man ] ; then \
	    rman -f HTML $(srcdir)/example/$$i.man > $(srcdir)/example/$$i.man.html ; \
	    cp $(srcdir)/example/$$i.man.html $(FTPDIR)/example ; \
	  else true; fi ; \
d569 6
a574 72
# add recursive support to the build process.
subdir_do: force
	@@for i in $(SUBDIRS); do \
	   echo "Making $(DO) in $${i}..." ; \
	   if [ -d ./$$i ] ; then \
	     if (rootme=`pwd`/ ; export rootme ; \
	       rootsrc=`cd $(srcdir); pwd`/ ; export rootsrc ; \
	       cd ./$$i; \
	       $(MAKE) $(FLAGS_TO_PASS) $(DO)) ; then true ; \
	     else exit 1 ; fi ; \
	   else true ; fi ; \
	done
force:

## dependencies will be put after this line... ##
Dbg.o: $(srcdir)/Dbg.c tcldbg.h 
exp_$(EVENT_ABLE).o: $(srcdir)/exp_$(EVENT_ABLE).c expect_cf.h expect.h \
	exp_command.h exp_event.h 
exp_$(EVENT_TYPE).o: $(srcdir)/exp_$(EVENT_TYPE).c expect_cf.h expect.h \
	exp_command.h exp_event.h 
exp_command.o: $(srcdir)/exp_command.c expect_cf.h exp_tty.h \
	exp_rename.h expect.h exp_command.h \
	exp_log.h exp_event.h exp_pty.h 
exp_console.o: $(srcdir)/exp_console.c expect_cf.h exp_rename.h exp_prog.h \
	exp_log.h
exp_glob.o: $(srcdir)/exp_glob.c expect_cf.h
exp_inter.o: $(srcdir)/exp_inter.c expect_cf.h \
	exp_tty_in.h exp_tty.h exp_rename.h expect.h exp_command.h \
	exp_log.h exp_regexp.h exp_tstamp.h
exp_log.o: $(srcdir)/exp_log.c expect_cf.h expect.h \
	exp_rename.h exp_log.h
exp_main_exp.o: $(srcdir)/exp_main_exp.c expect_cf.h \
	expect.h exp_rename.h exp_command.h exp_log.h
exp_main_sub.o: $(srcdir)/exp_main_sub.c expect_cf.h \
	exp_rename.h \
	expect.h exp_command.h exp_tty_in.h exp_tty.h exp_log.h \
	exp_event.h 
exp_main_tk.o: $(srcdir)/exp_main_tk.c expect_cf.h tcldbg.h
	$(CC) -c @@TK_DEFS@@ $(CFLAGS_INT) $(HDEFS) $<	
shared/exp_main_tk.o: $(srcdir)/exp_main_tk.c expect_cf.h tcldbg.h
	$(CC) -c @@TK_DEFS@@ $(CFLAGS_INT) $(HDEFS) $<	
exp_noevent.o: $(srcdir)/exp_noevent.c expect_cf.h exp_prog.h exp_command.h \
	exp_event.h
exp_poll.o: $(srcdir)/exp_poll.c expect_cf.h expect.h \
	exp_command.h exp_event.h 
	$(CC) -c $(CFLAGS_INT) @@TCL_DEFS@@ $(HDEFS) $<
shared/exp_poll.o: $(srcdir)/exp_poll.c expect_cf.h expect.h \
	exp_command.h exp_event.h 
	$(CC) -c $(CFLAGS_INT) @@EXP_SHLIB_CFLAGS@@ @@TCL_DEFS@@ $(HDEFS) $< -o shared/$@@
exp_pty.o: $(srcdir)/exp_pty.c expect_cf.h exp_rename.h exp_pty.h 
exp_regexp.o: $(srcdir)/exp_regexp.c expect_cf.h \
	expect.h exp_regexp.h 
exp_select.o: $(srcdir)/exp_select.c expect_cf.h \
	expect.h exp_command.h exp_event.h 
exp_simple.o: $(srcdir)/exp_simple.c expect_cf.h \
	expect.h exp_command.h exp_event.h 
exp_strf.o: $(srcdir)/exp_strf.c expect_cf.h
exp_trap.o: $(srcdir)/exp_trap.c expect_cf.h expect.h \
	exp_command.h exp_log.h
exp_tty.o: $(srcdir)/exp_tty.c expect_cf.h \
	expect.h exp_rename.h exp_tty_in.h exp_tty.h exp_log.h \
	exp_command.h 
exp_win.o: $(srcdir)/exp_win.c exp_win.h expect_cf.h
expect.o: $(srcdir)/expect.c expect_cf.h \
	exp_rename.h expect.h exp_command.h \
	exp_log.h exp_event.h exp_tty.h exp_tstamp.h
lib_exp.o: $(srcdir)/lib_exp.c expect_cf.h exp_rename.h expect.h
pty_sgttyb.o: $(srcdir)/pty_sgttyb.c expect_cf.h exp_rename.h exp_tty_in.h \
	exp_tty.h exp_pty.h 
pty_termios.o: $(srcdir)/pty_termios.c expect_cf.h exp_win.h \
	exp_tty_in.h exp_tty.h exp_rename.h exp_pty.h 
pty_unicos.o: $(srcdir)/pty_unicos.c expect_cf.h exp_rename.h 
@


5.40
log
@
	* Merged changes from the official version 5.39 of expect into the
	  SF sources. See details below. Partially already done.

	  --------------------
	  Poorva Gupta <poorva@@cup.hp.xcom> noted that grantpt/unlockpt
	  order was backward.  Strange that this was never a prob before!

	  Eric Raymond <esr@@snark.thyrsus.xcom> provided a troff-related
	  fix for the multixterm man page.

	  Nicolas Roeser <n-roeser@@gmx.xnet> noted confusion with md5 so I
	  made the Expect page more explicit about which file that hash
	  was based on.

	  Josh Purinton noted that earlier fix wasn't quite right.  Exit
	  on INT/TERM should cause Expect to exit with signal embedded in
	  status.  He also requested I obfuscate email addresses in this
	  file.

	  Guido Ostkamp <Guido.Ostkamp@@t-online.xde> and Igor Sobrado
	  <sobrado@@string1.ciencias.uniovi.xes> noted that fixline1
	  rewrote scripts to be expect scripts even if they were expectk
	  scripts.

	  Dirk Petera <dirkpetera@@yahoo.xcom> noted that any_spawn_id used
	  to work but did no longer.  Looks like a bug left over from the
	  the I18L conversion.  Fixed.

	  Steve Szabo noted exp_log_file -open channel failed.  Fixed.

	  Fixed bug from 5.31 that prevent stty from returning messages
	  from underlying program.

	  Thomas Dickey <dickey@@herndon4.his.xcom> noted that ncurses
	  ignores 2-char term names because of, well, poor assumptions and
	  coding.  Changed tkterm to use longer names.

	  Heath Moore <hmoore@@systran.xcom> noted that exp_clib could lock
	  up if remtime happened to be precisely 0.  Recoded to avoid.

	  At request of Per Otterholm <otterholm@@telia.xcom>, wrote script
	  to read from stdin and echo passwords (exercise 9 in Tk chapter
	  of Expect book).  Added to example directory as passwdprompt.

	  Josh Purinton <josh@@purinton.xorg> pointed out that by default,
	  SIGINT/TERM should cause expect's return status to be 1, not 0.

	  Paul Reithmuller <paul.reithmuller@@eng.sun.xcom> noted that
	  unbuffer shouldn't postprocess its output.  Added stty_init.

	  Mordechai T. Abzug <morty@@sanctuary.arbutus.md.xus> noted that
	  log_file wasn't recording -append status.

	  James Kelly <macubergeek@@comcast.xnet> noted weather example
	  needed new source.

	  Dimitar Haralanov <mitko@@tahoenetworks.xcom> noted that interact
	  dumped core with interact { timeout 1 }
	  --------------------
@
text
@d288 2
a289 1
		-DUSE_NON_CONST
@


5.39
log
@Forgot the makefile. Now disabled the relevant targets too.
@
text
@d673 1
a673 1
ftp:	expect-$(VERSION).tar.Z expect-$(VERSION).tar.gz install-html
d677 1
d683 1
a683 1
#	delete temp files
d750 5
a754 2
expect.tar.gz.md5:	$(FTPDIR)/expect.tar.gz
	md5 $(FTPDIR)/expect.tar.gz > expect.tar.gz.md5
@


5.38
log
@
	* Merged changes from the official version 5.38 of expect into the
	  SF sources. See details below.

	* Makefile.in: Added generation of MD5 checksum for distributed
	  archive.
	* rftp:         Bugfix by Curt Schroeder, see HISTORY
	* HISTORY:      Updated with new info.
	* configure:    Updated version info.
	* configure.in: Updated version info.
@
text
@d509 4
a512 4
Makefile: $(srcdir)/Makefile.in $(host_makefile_frag) config.status
	@@echo "Rebuilding the Makefile..."
	$(SHELL) ./config.status

d514 11
a524 11
configure: $(srcdir)/configure.in $(srcdir)/Makefile.in \
		$(srcdir)/expect_cf.h.in $(srcdir)/aclocal.m4
	@@echo "Rebuilding configure..."
	if [ x"${srcdir}" = x"@@srcdir@@" ] ; then \
	  srcdir=. ; export srcdir ; \
	else true ; fi ; \
	(cd $${srcdir}; autoconf)

config.status: $(srcdir)/configure
	@@echo "Rebuilding config.status..."
	$(SHELL) ./config.status --recheck
@


5.37
log
@multixterm fixes
@
text
@d746 1
a746 1
homepage.html:	homepage.src homepage.tcl
d748 3
@


5.36
log
@misc updates
@
text
@d754 3
d758 9
@


5.35
log
@Andreas Kupries mods to provide CONST support per TIP 27.
@
text
@d113 2
a114 1
	tknewsbiff unbuffer mkpasswd cryptdir decryptdir autoexpect
d118 1
a118 1
	passmass cryptdir decryptdir autoexpect
@


5.34
log
@Fixed printf formats in several pty diags.
@
text
@d286 2
a287 1
		-DTCL_DEBUGGER
@


5.33
log
@Fix for Debian SVR4 ptys.
@
text
@d674 1
a674 1
	cp expect-$(VERSION).tar.gz $(FTPDIR)/old/
@


5.32
log
@Merge of expect5-31-branch to mainline
@
text
@d435 2
a436 1
	$(INSTALL_DATA) $(TCLHDIR)/tclRegexp.h $(includedir)
d670 2
a671 1
ftp:	expect-$(VERSION).tar.Z expect-$(VERSION).tar.gz
@


5.31
log
@It should now be possible to configure expect with the same configure
arguments used to configure Tcl.

Makefile targets now consistent with Tcl Makefile targets.
@
text
@d240 2
a241 2
	exp_printify.c exp_trap.c exp_strf.c \
	exp_console.c exp_glob.c exp_win.c Dbg.c exp_clib.c \
d243 2
a244 1
	exp_$(EVENT_TYPE).c exp_$(EVENT_ABLE).c
d246 2
a247 2
	exp_log.o exp_main_sub.o exp_pty.o exp_printify.o exp_trap.o \
	exp_console.o exp_strf.o exp_glob.o exp_win.o Dbg.o exp_clib.o \
d249 2
a250 1
	exp_$(EVENT_TYPE).o exp_$(EVENT_ABLE).o
d254 1
a254 1
	shared/exp_printify.o shared/exp_trap.o \
d256 1
a256 1
	shared/exp_win.o shared/Dbg.o shared/exp_clib.o \
d258 2
a259 1
	shared/exp_$(EVENT_TYPE).o shared/exp_$(EVENT_ABLE).o
a426 1
	  $(INSTALL_DATA) $(srcdir)/expectk.man $(man1dir)/expectk.1 ; \
a427 4
# install Expect man page
	$(INSTALL_DATA) $(srcdir)/expect.man $(man1dir)/expect.1
# install man page for Expect and Expectk libraries
	$(INSTALL_DATA) $(srcdir)/libexpect.man $(man3dir)/libexpect.3
d456 9
d638 3
d643 1
a643 1
	#load $(CPPFLAGS) $(STTY) $(CFILES) exp_main_exp.c $(TCLLIB) $(GCCLIB) $(EXP_AND_TCL_LIBS)
a661 2
# until we are completely switched over, keep updating old ftp site too
OLDFTPDIR = /proj/elib/online/pub/expect
d672 1
a677 8
#	update old ftp site too
	cp expect-$(VERSION).tar.Z $(OLDFTPDIR)/expect.tar.Z
	cp expect-$(VERSION).tar.gz $(OLDFTPDIR)/expect.tar.gz
	cp HISTORY $(OLDFTPDIR)
	cp README $(OLDFTPDIR)/README.distribution
	cp example/README $(OLDFTPDIR)/example
	cp `pubfile example` $(OLDFTPDIR)/example
	ls -l $(OLDFTPDIR)/expect.tar*
a680 2


d717 1
a717 1
	echo "source all" >> .tmp
d774 1
a774 1
	exp_log.h exp_printify.h exp_event.h exp_pty.h 
d780 1
a780 1
	exp_log.h exp_printify.h exp_regexp.h exp_tstamp.h
d782 1
a782 1
	exp_rename.h exp_log.h exp_printify.h 
d784 1
a784 1
	expect.h exp_rename.h exp_command.h exp_log.h exp_printify.h
d788 1
a788 1
	exp_printify.h exp_event.h 
a800 1
exp_printify.o: $(srcdir)/exp_printify.c expect_cf.h 
d810 1
a810 1
	exp_command.h exp_log.h exp_printify.h 
d813 1
a813 1
	exp_printify.h exp_command.h 
d817 2
a818 3
	exp_log.h exp_printify.h exp_event.h exp_tty.h exp_tstamp.h
lib_exp.o: $(srcdir)/lib_exp.c expect_cf.h exp_rename.h expect.h \
	exp_printify.h
@


5.30
log
@numerous edits - getting synchronized (first time I've used CVS), see
HISTORY file for more info
@
text
@d327 3
a329 1
all: expect $(EXP_LIB_FILES) ${X11_PROGS}
d332 4
d415 3
a417 1
install:	expect expect_installed ${X11_PROGS_INSTALLED} $(SCRIPTS)
d446 2
d456 2
@


5.30.2.1
log
@fixed Log/Diag and ExpectCmd
@
text
@d243 1
a243 1
	exp_$(EVENT_TYPE).c exp_$(EVENT_ABLE).c expTcl.c
d248 1
a248 1
	exp_$(EVENT_TYPE).o exp_$(EVENT_ABLE).o expTcl.o
d256 1
a256 1
	shared/exp_$(EVENT_TYPE).o shared/exp_$(EVENT_ABLE).o expTcl.o
@


5.30.2.2
log
@made stuff compile
@
text
@d240 1
a240 1
	exp_trap.c exp_strf.c \
d245 1
a245 1
	exp_log.o exp_main_sub.o exp_pty.o exp_trap.o \
d252 1
a252 1
	shared/exp_trap.o \
d763 1
a763 1
	exp_log.h exp_event.h exp_pty.h 
d769 1
a769 1
	exp_log.h exp_regexp.h exp_tstamp.h
d771 1
a771 1
	exp_rename.h exp_log.h
d773 1
a773 1
	expect.h exp_rename.h exp_command.h exp_log.h
d777 1
a777 1
	exp_event.h 
d790 1
d800 1
a800 1
	exp_command.h exp_log.h
d803 1
a803 1
	exp_command.h 
d807 3
a809 2
	exp_log.h exp_event.h exp_tty.h exp_tstamp.h
lib_exp.o: $(srcdir)/lib_exp.c expect_cf.h exp_rename.h expect.h
@


5.30.2.3
log
@compiled!
@
text
@d241 1
a241 1
	exp_console.c exp_glob.c exp_win.c exp_clib.c \
d243 1
a243 2
	exp_$(EVENT_TYPE).c exp_$(EVENT_ABLE).c expTcl.c \
	exp_chan.c Dbg.c
d246 1
a246 1
	exp_console.o exp_strf.o exp_glob.o exp_win.o exp_clib.o \
d248 1
a248 2
	exp_$(EVENT_TYPE).o exp_$(EVENT_ABLE).o expTcl.o \
	exp_chan.o Dbg.o
d254 1
a254 1
	shared/exp_win.o shared/exp_clib.o \
d256 1
a256 2
	shared/exp_$(EVENT_TYPE).o shared/exp_$(EVENT_ABLE).o expTcl.o \
	shared/exp_chan.o shared/Dbg.o
d283 1
a283 2

#		-DTCL_DEBUGGER
@


5.30.2.4
log
@Implemented TEA changes from mainline
@
text
@d331 1
a331 3
all: binaries libraries doc

binaries: expect $(EXP_LIB_FILES) ${X11_PROGS}
a333 4
libraries:

doc: info dvi

d413 1
a413 3
install: all install-binaries install-libraries install-doc

install-binaries: expect expect_installed ${X11_PROGS_INSTALLED} $(SCRIPTS)
a441 2

install-libraries:
a449 2

install-doc:
@


5.30.2.5
log
@fixed problem linking when building shared objs on hpux.
@
text
@d414 1
a414 1
	@@TCL_SHLIB_LD@@ -o $(EXP_SHARED_LIB_FILE) $(SHARED_OFILES) @@TCL_LD_SEARCH_FLAGS@@ @@EXP_SHLIB_LD_LIBS@@
@


5.30.2.6
log
@Expect should now be passing linker-style flags to the linker and
compiler-style link flags to the compiler.  There was an anomoly on
Solaris where the linker, /usr/ccs/bin/ld was getting -Wl,-R...
The configure script now checks to see if the linker and the compiler
are the same program and transforms the link flags if they are not.
@
text
@d414 1
a414 1
	@@TCL_SHLIB_LD@@ -o $(EXP_SHARED_LIB_FILE) $(SHARED_OFILES) @@EXP_LD_SEARCH_FLAGS@@ @@EXP_SHLIB_LD_LIBS@@
@


5.30.2.7
log
@The install-doc target now installs the expect, expectk, and libexpect man pages.
@
text
@d428 1
d430 4
a461 9
	${srcdir}/mkinstalldirs $(man1dir) $(man3dir)
# install Expectk man page if present
	-if [ -s expectk_installed ] ; then \
	  $(INSTALL_DATA) $(srcdir)/expectk.man $(man1dir)/expectk.1 ; \
	else true; fi
# install Expect man page
	$(INSTALL_DATA) $(srcdir)/expect.man $(man1dir)/expect.1
# install man page for Expect and Expectk libraries
	$(INSTALL_DATA) $(srcdir)/libexpect.man $(man3dir)/libexpect.3
@


5.30.2.8
log
@Enabled TCL_DEBUGGER
@
text
@d286 2
a287 1
		-DTCL_DEBUGGER
@


5.30.2.9
log
@* Makefile.in: Changed test target to source tests/all.tcl instead
of tests/all

* tests/README: Modified documentation to reflect the change from
usage of a defs file to the use of package tcltest to run the tests

* tests/all:
* tests/defs:
* tests/all.tcl:
* tests/cat.test:
* tests/expect.test:
* tests/logfile.test:
* tests/pid.test:
* tests/send.test:
* tests/spawn.test
* tests/stty.test: Modified test files to use package tcltest,
removed tests/all and tests/defs, and added tests/all.tcl
@
text
@d725 1
a725 1
	echo "source all.tcl" >> .tmp
@


5.30.2.10
log
@In interact, fixed encoding bug and -echo bug.
Made Makefile.in support CodeCenter better.
Fixed regexp bug in debugger.
@
text
@a637 3
# Note that CodeCenter doesn't understand backslashes in STTY - there is a
# default value in the code itself that is used.  So if you don't use the default,
# you'll have to hand-edit the source.
d640 1
a640 1
	#load $(CPPFLAGS) $(CFILES) exp_main_exp.c $(TCLLIB) $(GCCLIB) $(EXP_AND_TCL_LIBS)
@


5.30.2.11
log
@Fixes for picky HP compiler.
@
text
@d243 1
a243 1
	exp_$(EVENT_TYPE).c exp_$(EVENT_ABLE).c \
d249 1
a249 1
	exp_$(EVENT_TYPE).o exp_$(EVENT_ABLE).o \
d258 1
a258 1
	shared/exp_$(EVENT_TYPE).o shared/exp_$(EVENT_ABLE).o \
d662 2
a673 1
	cp expect-$(VERSION).tar.gz $(FTPDIR)/old/
d679 8
d689 2
@


5.29
log
@Created two new macors "expect-unshared-lib-file" and "expect-shared-lib-file"
  that basically only build the respective library files.  There was no such
  target before.
@
text
@d64 1
a64 1
# Tcl libraries built with optimization switches have this additional extension
d66 1
d99 7
d172 5
a176 5
bindir            = @@bindir@@
bindir_arch_indep = $(prefix)/bin
tcl_libdir        = @@libdir@@
libdir            = @@libdir@@/expect$(VERSION)
libdir_arch_indep = $(prefix)/lib/expect$(VERSION)
d178 1
a178 1
mandir 	= @@mandir@@
d181 2
a182 2
infodir = @@infodir@@
includedir = @@includedir@@
d199 1
a199 1
LOCAL_EXPECT=LD_LIBRARY_PATH=.:$$LD_LIBRARY_PATH ./expect
d334 1
d371 2
a372 1
# Build an executable with both Expect and Tk.
d764 3
d798 1
a798 1
exp_strf.o: $(srcdir)/exp_strf.c
d804 1
a804 1
exp_win.o: $(srcdir)/exp_win.c exp_win.h 
@


5.28
log
@Initial revision
@
text
@d381 1
d391 1
@


5.28.1.1
log
@Import of Expect v. 5.28.1
@
text
@@
