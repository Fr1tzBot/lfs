head	5.35;
access;
symbols
	expect_5_45:5.35
	expect_6_branch:5.35.0.2
	expect_5_44_1_15:5.35
	activestate_win32_port_start:5.31
	telco-tec-win32-take2-branch:5.29.0.6
	telco-tec-win32-branch:5.29.0.4
	expect-sf418892-sf439042-branch:5.29.0.2
	tclpro-1-5-0:5.29
	tclpro-1-4-1:5.29
	tclpro-1-4-0:5.29
	expect-5-32-2:5.29
	expect-5-32-0:5.29
	ajuba-ajuba2-2-0:5.28.1.1.2.5
	scriptics-sc-2-0-b5:5.28.1.1.2.5
	scriptics-sc-2-0-fixed:5.28.1.1.2.5
	scriptics-sc-2-0-b2:5.28.1.1.2.5
	scriptics-sc-2-0-b1:5.28.1.1.2.5
	scriptics-sc-1-1:5.28.1.1.2.5
	scriptics-sc-1-1-b1:5.28.1.1.2.5
	scriptics-sc-1-1-branch:5.28.1.1.2.5.0.4
	scriptics-sc-1-1-base:5.28.1.1.2.5
	scriptics-sc-1-0:5.28.1.1.2.5
	scriptics-sc-1-0-branch:5.28.1.1.2.5.0.2
	scriptics-sc-1-0-base:5.28.1.1.2.5
	expect-5-31-3:5.28.1.1.2.5
	scriptics-bc-1-0-b1:5.28.1.1.2.5
	scriptics-tclpro-1-3-0:5.28.1.1.2.5
	scriptics-tclpro-1-3-b4:5.28.1.1.2.5
	scriptics-tclpro-1-3-b3:5.28.1.1.2.5
	expect-5-31:5.28.1.1.2.5
	expect-5-31-branch:5.28.1.1.0.2
	expect-5-31-base:5.28.1.1
	scriptics-tclpro-1-2:5.28.1.1
	scriptics-tclpro-1-2-b2:5.28.1.1
	scriptics-tclpro-1-2-b1:5.28.1.1
	scriptics-tclpro-1-2-a1:5.28.1.1
	expect-5-28-1:5.28.1.1
	expect:5.28.1;
locks; strict;
comment	@ * @;


5.35
date	2010.07.01.00.53.49;	author eee;	state Exp;
branches;
next	5.34;

5.34
date	2010.03.17.23.47.50;	author eee;	state Exp;
branches;
next	5.33;

5.33
date	2007.07.11.21.35.08;	author andreas_kupries;	state Exp;
branches;
next	5.32;

5.32
date	2005.02.15.18.11.10;	author andreas_kupries;	state Exp;
branches;
next	5.31;

5.31
date	2002.04.16.21.00.28;	author libes;	state Exp;
branches;
next	5.30;

5.30
date	2002.03.23.04.55.04;	author libes;	state Exp;
branches;
next	5.29;

5.29
date	2000.01.06.23.22.04;	author wart;	state Exp;
branches
	5.29.4.1
	5.29.6.1;
next	5.28;

5.28
date	98.10.14.22.53.22;	author cvsadmin;	state Exp;
branches
	5.28.1.1;
next	;

5.28.1.1
date	98.10.14.22.53.22;	author cvsadmin;	state Exp;
branches
	5.28.1.1.2.1;
next	;

5.28.1.1.2.1
date	99.06.11.02.10.19;	author stanton;	state Exp;
branches;
next	5.28.1.1.2.2;

5.28.1.1.2.2
date	99.06.14.20.36.49;	author don;	state Exp;
branches;
next	5.28.1.1.2.3;

5.28.1.1.2.3
date	99.06.14.23.54.06;	author don;	state Exp;
branches;
next	5.28.1.1.2.4;

5.28.1.1.2.4
date	99.06.15.19.11.58;	author don;	state Exp;
branches;
next	5.28.1.1.2.5;

5.28.1.1.2.5
date	99.06.15.22.52.58;	author don;	state Exp;
branches;
next	;

5.29.4.1
date	2001.10.02.23.04.51;	author davygrvy;	state dead;
branches;
next	;

5.29.6.1
date	2001.11.22.08.50.37;	author davygrvy;	state dead;
branches;
next	;


desc
@@


5.35
log
@Undoing all changes made by me during ANSIfication attempt, and
reverting to tag 'expect_5_44_1_15'.  Further ANSIfication will
be pursued on a branch.
@
text
@/* exp_log.h */

extern void		expErrorLog _ANSI_ARGS_(TCL_VARARGS(char *,fmt));
extern void		expErrorLogU _ANSI_ARGS_((char *));

extern void		expStdoutLog _ANSI_ARGS_(TCL_VARARGS(int,force_stdout));
extern void		expStdoutLogU _ANSI_ARGS_((char *buf, int force_stdout));

EXTERN void		expDiagInit _ANSI_ARGS_((void));
EXTERN int		expDiagChannelOpen _ANSI_ARGS_((Tcl_Interp *,char *));
EXTERN Tcl_Channel	expDiagChannelGet _ANSI_ARGS_((void));
EXTERN void		expDiagChannelClose _ANSI_ARGS_((Tcl_Interp *));
EXTERN char *		expDiagFilename _ANSI_ARGS_((void));
EXTERN int		expDiagToStderrGet _ANSI_ARGS_((void));
EXTERN void		expDiagToStderrSet _ANSI_ARGS_((int));
EXTERN void		expDiagWriteBytes _ANSI_ARGS_((char *,int));
EXTERN void		expDiagWriteChars _ANSI_ARGS_((char *,int));
EXTERN void		expDiagWriteObj _ANSI_ARGS_((Tcl_Obj *));
EXTERN void		expDiagLog _ANSI_ARGS_(TCL_VARARGS(char *,fmt));
EXTERN void		expDiagLogU _ANSI_ARGS_((char *));

EXTERN char *		expPrintify _ANSI_ARGS_((char *));
EXTERN char *		expPrintifyUni _ANSI_ARGS_((Tcl_UniChar *,int));
EXTERN char *		expPrintifyObj _ANSI_ARGS_((Tcl_Obj *));
EXTERN void		expPrintf _ANSI_ARGS_(TCL_VARARGS(char *,fmt));

EXTERN void		expLogInit _ANSI_ARGS_((void));
EXTERN int		expLogChannelOpen _ANSI_ARGS_((Tcl_Interp *,char *,int));
EXTERN Tcl_Channel 	expLogChannelGet _ANSI_ARGS_((void));
EXTERN int		expLogChannelSet _ANSI_ARGS_((Tcl_Interp *,char *));
EXTERN void		expLogChannelClose _ANSI_ARGS_((Tcl_Interp *));
EXTERN char *		expLogFilenameGet _ANSI_ARGS_((void));
EXTERN void		expLogAppendSet _ANSI_ARGS_((int));
EXTERN int		expLogAppendGet _ANSI_ARGS_((void));
EXTERN void		expLogLeaveOpenSet _ANSI_ARGS_((int));
EXTERN int		expLogLeaveOpenGet _ANSI_ARGS_((void));
EXTERN void		expLogAllSet _ANSI_ARGS_((int));
EXTERN int		expLogAllGet _ANSI_ARGS_((void));
EXTERN void		expLogToStdoutSet _ANSI_ARGS_((int));
EXTERN int		expLogToStdoutGet _ANSI_ARGS_((void));
EXTERN void		expLogDiagU _ANSI_ARGS_((char *));
EXTERN int		expWriteBytesAndLogIfTtyU _ANSI_ARGS_((ExpState *,Tcl_UniChar *,int));

EXTERN int		expLogUserGet _ANSI_ARGS_((void));
EXTERN void		expLogUserSet _ANSI_ARGS_((int));

EXTERN void		expLogInteractionU _ANSI_ARGS_((ExpState *,Tcl_UniChar *,int));
@


5.34
log
@ANSIfication changes
@
text
@d3 2
a4 2
extern void		expErrorLog TCL_VARARGS(char *,fmt);
extern void		expErrorLogU (char *);
d6 2
a7 2
extern void		expStdoutLog TCL_VARARGS(int,force_stdout);
extern void		expStdoutLogU (char *buf, int force_stdout);
d9 34
a42 34
EXTERN void		expDiagInit (void);
EXTERN int		expDiagChannelOpen (Tcl_Interp *,char *);
EXTERN Tcl_Channel	expDiagChannelGet (void);
EXTERN void		expDiagChannelClose (Tcl_Interp *);
EXTERN char *		expDiagFilename (void);
EXTERN int		expDiagToStderrGet (void);
EXTERN void		expDiagToStderrSet (int);
EXTERN void		expDiagWriteBytes (char *,int);
EXTERN void		expDiagWriteChars (char *,int);
EXTERN void		expDiagWriteObj (Tcl_Obj *);
EXTERN void		expDiagLog TCL_VARARGS(char *,fmt);
EXTERN void		expDiagLogU (char *);

EXTERN char *		expPrintify (char *);
EXTERN char *		expPrintifyUni (Tcl_UniChar *,int);
EXTERN char *		expPrintifyObj (Tcl_Obj *);
EXTERN void		expPrintf TCL_VARARGS(char *,fmt);

EXTERN void		expLogInit (void);
EXTERN int		expLogChannelOpen (Tcl_Interp *,char *,int);
EXTERN Tcl_Channel 	expLogChannelGet (void);
EXTERN int		expLogChannelSet (Tcl_Interp *,char *);
EXTERN void		expLogChannelClose (Tcl_Interp *);
EXTERN char *		expLogFilenameGet (void);
EXTERN void		expLogAppendSet (int);
EXTERN int		expLogAppendGet (void);
EXTERN void		expLogLeaveOpenSet (int);
EXTERN int		expLogLeaveOpenGet (void);
EXTERN void		expLogAllSet (int);
EXTERN int		expLogAllGet (void);
EXTERN void		expLogToStdoutSet (int);
EXTERN int		expLogToStdoutGet (void);
EXTERN void		expLogDiagU (char *);
EXTERN int		expWriteBytesAndLogIfTtyU (ExpState *,Tcl_UniChar *,int);
d44 2
a45 2
EXTERN int		expLogUserGet (void);
EXTERN void		expLogUserSet (int);
d47 1
a47 1
EXTERN void		expLogInteractionU (ExpState *,Tcl_UniChar *,int);
@


5.33
log
@
	* exp_chan.c: Converted the buffering system from UTF-8 in Tcl_Obj
	* exp_command.h: to UTF-16 C-array, to avoid the repeated conversion
	* expect.c: of the input from utf-8 to utf-16. Updated the glob
	* exp_glob.c: matching code to use the same tricks for speed which
	* exp_inter.c: are used by the Tcl core. Extended the regexp
	* exp_log.c: matching path with a glob matcher which uses a gate
	* exp_log.h: keeper glob pattern to weed out most non-candidates
	* retoglob.c (New file): in a speedy manner. Regexp matching now
	  has to be done only for the small number of candidates
	  identified by the gate keeper. Overall speed improvement as glob
	  matching is faster than regexp matching. Added code translating
	  regular expressions into their gate keeper glob pattern.
@
text
@d3 2
a4 2
extern void		expErrorLog _ANSI_ARGS_(TCL_VARARGS(char *,fmt));
extern void		expErrorLogU _ANSI_ARGS_((char *));
d6 2
a7 2
extern void		expStdoutLog _ANSI_ARGS_(TCL_VARARGS(int,force_stdout));
extern void		expStdoutLogU _ANSI_ARGS_((char *buf, int force_stdout));
d9 34
a42 34
EXTERN void		expDiagInit _ANSI_ARGS_((void));
EXTERN int		expDiagChannelOpen _ANSI_ARGS_((Tcl_Interp *,char *));
EXTERN Tcl_Channel	expDiagChannelGet _ANSI_ARGS_((void));
EXTERN void		expDiagChannelClose _ANSI_ARGS_((Tcl_Interp *));
EXTERN char *		expDiagFilename _ANSI_ARGS_((void));
EXTERN int		expDiagToStderrGet _ANSI_ARGS_((void));
EXTERN void		expDiagToStderrSet _ANSI_ARGS_((int));
EXTERN void		expDiagWriteBytes _ANSI_ARGS_((char *,int));
EXTERN void		expDiagWriteChars _ANSI_ARGS_((char *,int));
EXTERN void		expDiagWriteObj _ANSI_ARGS_((Tcl_Obj *));
EXTERN void		expDiagLog _ANSI_ARGS_(TCL_VARARGS(char *,fmt));
EXTERN void		expDiagLogU _ANSI_ARGS_((char *));

EXTERN char *		expPrintify _ANSI_ARGS_((char *));
EXTERN char *		expPrintifyUni _ANSI_ARGS_((Tcl_UniChar *,int));
EXTERN char *		expPrintifyObj _ANSI_ARGS_((Tcl_Obj *));
EXTERN void		expPrintf _ANSI_ARGS_(TCL_VARARGS(char *,fmt));

EXTERN void		expLogInit _ANSI_ARGS_((void));
EXTERN int		expLogChannelOpen _ANSI_ARGS_((Tcl_Interp *,char *,int));
EXTERN Tcl_Channel 	expLogChannelGet _ANSI_ARGS_((void));
EXTERN int		expLogChannelSet _ANSI_ARGS_((Tcl_Interp *,char *));
EXTERN void		expLogChannelClose _ANSI_ARGS_((Tcl_Interp *));
EXTERN char *		expLogFilenameGet _ANSI_ARGS_((void));
EXTERN void		expLogAppendSet _ANSI_ARGS_((int));
EXTERN int		expLogAppendGet _ANSI_ARGS_((void));
EXTERN void		expLogLeaveOpenSet _ANSI_ARGS_((int));
EXTERN int		expLogLeaveOpenGet _ANSI_ARGS_((void));
EXTERN void		expLogAllSet _ANSI_ARGS_((int));
EXTERN int		expLogAllGet _ANSI_ARGS_((void));
EXTERN void		expLogToStdoutSet _ANSI_ARGS_((int));
EXTERN int		expLogToStdoutGet _ANSI_ARGS_((void));
EXTERN void		expLogDiagU _ANSI_ARGS_((char *));
EXTERN int		expWriteBytesAndLogIfTtyU _ANSI_ARGS_((ExpState *,Tcl_UniChar *,int));
d44 2
a45 2
EXTERN int		expLogUserGet _ANSI_ARGS_((void));
EXTERN void		expLogUserSet _ANSI_ARGS_((int));
d47 1
a47 1
EXTERN void		expLogInteractionU _ANSI_ARGS_((ExpState *,Tcl_UniChar *,int));
@


5.32
log
@
	* Merged changes from the official versions 5.42.1 and 5.43.0 of
	  expect into the SF sources. See the details below.

	  --------------------
	  Martin Forssen <maf@@tkrat.xorg> fixed bug in ExpOutputProc
	  that caused misbehavior during partial writes.

	  Someone noted that gets stdin behaves differently (returns -1
	  immediately) from tclsh because with 5.42, stdin is unblocked by
	  defaults.

	  Robroy Gregg <robroy@@armory.xcom> noted that expect_background
	  ignores timeouts.  Added to documentation.

	  Jens Peterson <peterson@@redhat.xcom> provided patch for
	  "mkpasswd -vo".

	  Gary Bliesener <gary.bliesener@@nextel.xcom> noted that
	  multixterm failed on his system which had an old Tk that didn't
	  support the Tk package.

	  Removed beta designation.

	  Daniel A. Steffen <steffen@@ics.mq.edu.xau> provided patch for
	  MacOS to avoid panic-redefinition.
	  --------------------
@
text
@d23 1
d42 1
a42 1
EXTERN int		expWriteBytesAndLogIfTtyU _ANSI_ARGS_((ExpState *,char *,int));
d47 1
a47 1
EXTERN void		expLogInteractionU _ANSI_ARGS_((ExpState *,char *));
@


5.31
log
@misc updates
@
text
@d24 1
@


5.30
log
@Andreas Kupries mods to provide CONST support per TIP 27.
@
text
@d4 1
a4 1
extern void		expErrorLogU _ANSI_ARGS_((CONST char *));
d7 1
a7 1
extern void		expStdoutLogU _ANSI_ARGS_((CONST char *buf, int force_stdout));
d16 2
a17 2
EXTERN void		expDiagWriteBytes _ANSI_ARGS_((CONST char *,int));
EXTERN void		expDiagWriteChars _ANSI_ARGS_((CONST char *,int));
d20 1
a20 1
EXTERN void		expDiagLogU _ANSI_ARGS_((CONST char *));
@


5.29
log
@Merge of expect5-31-branch to mainline
@
text
@d4 1
a4 1
extern void		expErrorLogU _ANSI_ARGS_((char *));
d7 1
a7 1
extern void		expStdoutLogU _ANSI_ARGS_((char *buf, int force_stdout));
d16 2
a17 2
EXTERN void		expDiagWriteBytes _ANSI_ARGS_((char *,int));
EXTERN void		expDiagWriteChars _ANSI_ARGS_((char *,int));
d20 1
a20 1
EXTERN void		expDiagLogU _ANSI_ARGS_((char *));
@


5.29.6.1
log
@A working set of code against Tcl8.4!
@
text
@@


5.29.4.1
log
@Top-level source files removed.
@
text
@@


5.28
log
@Initial revision
@
text
@d3 2
a4 1
#include "exp_printify.h"
d6 2
a7 22
/* special version of log for non-null-terminated strings which */
/* never need printf-style formatting. */
#define logn(buf,length)  { \
			  if (logfile) fwrite(buf,1,length,logfile); \
			  if (debugfile) fwrite(buf,1,length,debugfile); \
			  }

#define dprintify(x)	((is_debugging || debugfile)?exp_printify(x):0)
/* in circumstances where "debuglog(printify(...))" is written, call */
/* dprintify instead.  This will avoid doing any formatting that would */
/* occur before debuglog got control and decided not to do anything */
/* because (is_debugging || debugfile) was false. */

extern void exp_errorlog _ANSI_ARGS_(TCL_VARARGS(char *,fmt));
extern void exp_log _ANSI_ARGS_(TCL_VARARGS(int,force_stdout));
extern void exp_debuglog _ANSI_ARGS_(TCL_VARARGS(char *,fmt));
extern void exp_nflog _ANSI_ARGS_((char *buf, int force_stdout));
extern void exp_nferrorlog _ANSI_ARGS_((char *buf, int force_stdout));

extern FILE *debugfile;
extern FILE *logfile;
extern int logfile_all;
d9 37
a45 1
extern int is_debugging;	/* useful to know for avoid debug calls */
@


5.28.1.1
log
@Import of Expect v. 5.28.1
@
text
@@


5.28.1.1.2.1
log
@modified expect command to use new regexp interfaces, made various
I18N changes
@
text
@a12 1
#define dprintifyobj(x)	((is_debugging || debugfile)?exp_printify(Tcl_GetString(x)):0)
@


5.28.1.1.2.2
log
@fixed Log/Diag and ExpectCmd
@
text
@d5 23
a27 2
extern void		expErrorLog _ANSI_ARGS_(TCL_VARARGS(char *,fmt));
extern void		expErrorLogU _ANSI_ARGS_((char *buf, int force_stdout));
d29 1
a29 40
extern void		expStdoutLog _ANSI_ARGS_(TCL_VARARGS(int,force_stdout));
extern void		expStdoutLogU _ANSI_ARGS_((char *buf, int force_stdout));

EXTERN void		expDiagInit _ANSI_ARGS_((void));
EXTERN int		expDiagChannelOpen _ANSI_ARGS_((Tcl_Interp *,char *));
EXTERN Tcl_Channel	expDiagChannelGet _ANSI_ARGS_((void));
EXTERN void		expDiagChannelClose _ANSI_ARGS_((void));
EXTERN char *		expDiagFilename _ANSI_ARGS_((void));
EXTERN int		expDiagToStderrGet _ANSI_ARGS_((void));
EXTERN void		expDiagToStderrSet _ANSI_ARGS_((int));
EXTERN void		expDiagWriteBytes _ANSI_ARGS_((char *));
EXTERN void		expDiagWriteChars _ANSI_ARGS_((char *));
EXTERN void		expDiagWriteObj _ANSI_ARGS_((Tcl_Object *));
EXTERN void		expDiagLog _ANSI_ARGS_(TCL_VARARGS(char *,fmt));
EXTERN void		expDiagLogU _ANSI_ARGS_((char *));

EXTERN void		expPrintify _ANSI_ARGS_((char *));
EXTERN void		expPrintifyObj _ANSI_ARGS_((Tcl_Obj *));

EXTERN void		expLogInit _ANSI_ARGS_((void));
EXTERN int		expLogChannelOpen _ANSI_ARGS_((Tcl_Interp *,char *));
EXTERN Tcl_Channel 	expLogChannelGet _ANSI_ARGS_((void));
EXTERN void		expLogChannelSet _ANSI_ARGS_((Tcl_Channel));
EXTERN void		expLogChannelClose _ANSI_ARGS_((void));
EXTERN char *		expLogFilenameGet _ANSI_ARGS_((void));
EXTERN void		expLogAppendSet _ANSI_ARGS_((int));
EXTERN int		expLogAppendGet _ANSI_ARGS_((void));
EXTERN void		expLogLeaveOpenSet _ANSI_ARGS_((int));
EXTERN int		expLogLeaveOpenGet _ANSI_ARGS_((void));
EXTERN void		expLogAllSet _ANSI_ARGS_((int));
EXTERN int		expLogAllGet _ANSI_ARGS_((void));
EXTERN void		expLogToStdoutSet _ANSI_ARGS_((int));
EXTERN int		expLogToStdoutGet _ANSI_ARGS_((void));
EXTERN void		expLogDiagU _ANSI_ARGS_((char *));
EXTERN void		expWriteBytesAndLogIfTtyU _ANSI_ARGS_((ExpState *,char *,int));

EXTERN int		expLogUserGet _ANSI_ARGS_((void));
EXTERN void		expLogUserSet _ANSI_ARGS_((int));

EXTERN void		expLogInteractionU _ANSI_ARGS_((ExpState *,char *));
@


5.28.1.1.2.3
log
@made stuff compile
@
text
@d3 2
d6 1
a6 1
extern void		expErrorLogU _ANSI_ARGS_((char *));
d20 1
a20 1
EXTERN void		expDiagWriteObj _ANSI_ARGS_((Tcl_Obj *));
d24 2
a25 2
EXTERN char *		expPrintify _ANSI_ARGS_((char *));
EXTERN char *		expPrintifyObj _ANSI_ARGS_((Tcl_Obj *));
d28 1
a28 1
EXTERN int		expLogChannelOpen _ANSI_ARGS_((Tcl_Interp *,char *,int));
@


5.28.1.1.2.4
log
@Fixed interact of all but regexp probs.
@
text
@d12 1
a12 1
EXTERN void		expDiagChannelClose _ANSI_ARGS_((Tcl_Interp *));
d16 2
a17 2
EXTERN void		expDiagWriteBytes _ANSI_ARGS_((char *,int));
EXTERN void		expDiagWriteChars _ANSI_ARGS_((char *,int));
d28 2
a29 2
EXTERN int		expLogChannelSet _ANSI_ARGS_((Tcl_Channel,char *));
EXTERN void		expLogChannelClose _ANSI_ARGS_((Tcl_Interp *));
d40 1
a40 1
EXTERN int		expWriteBytesAndLogIfTtyU _ANSI_ARGS_((ExpState *,char *,int));
@


5.28.1.1.2.5
log
@Everything but Dbg.c
@
text
@d28 1
a28 1
EXTERN int		expLogChannelSet _ANSI_ARGS_((Tcl_Interp *,char *));
@


